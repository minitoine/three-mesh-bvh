function e(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}var t=globalThis,r={},n={},i=t.parcelRequire4485;null==i&&((i=function(e){if(e in r)return r[e].exports;if(e in n){var t=n[e];delete n[e];var i={id:e,exports:{}};return r[e]=i,t.call(i.exports,i,i.exports),i.exports}var o=Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){n[e]=t},t.parcelRequire4485=i);var o=i.register;o("ff8ed",function(t,r){e(t.exports,"MeshBVH",()=>D);var n=i("ilwiq"),o=i("Mleu6"),a=i("4ARWa"),s=i("4ytBV"),l=i("aw71y"),u=i("6DMlg"),c=i("aPqeh"),f=i("38TIa"),d=i("8Nb8u"),p=i("6pOPX"),x=i("01T8e"),y=i("9Aami"),g=i("iWlby"),B=i("hKG28"),T=i("jRigT"),h=i("fRYTF"),A=i("6O8bC"),m=i("cmjuj"),E=i("7rVal"),_=i("ipmev"),w=i("2zRsl"),N=i("2GwQ0"),I=i("eLAt7");let S=new s.OrientedBox,O=new n.Box3,b={strategy:o.CENTER,maxDepth:40,maxLeafTris:10,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,indirect:!1,verbose:!0};class D{static serialize(e,t={}){t={cloneBuffers:!0,...t};let r=e.geometry,n=e._roots,i=e._indirectBuffer,o=r.getIndex();return t.cloneBuffers?{roots:n.map(e=>e.slice()),index:o?o.array.slice():null,indirectBuffer:i?i.slice():null}:{roots:n,index:o?o.array:null,indirectBuffer:i}}static deserialize(e,t,r={}){r={setIndex:!0,indirect:!!e.indirectBuffer,...r};let{index:i,roots:a,indirectBuffer:s}=e,l=new D(t,{...r,[o.SKIP_GENERATION]:!0});if(l._roots=a,l._indirectBuffer=s||null,r.setIndex){let r=t.getIndex();if(null===r){let r=new n.BufferAttribute(e.index,1,!1);t.setIndex(r)}else r.array!==i&&(r.array.set(i),r.needsUpdate=!0)}return l}get indirect(){return!!this._indirectBuffer}constructor(e,t={}){if(e.isBufferGeometry){if(e.index&&e.index.isInterleavedBufferAttribute)throw Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw Error("MeshBVH: Only BufferGeometries are supported.");if((t=Object.assign({...b,[o.SKIP_GENERATION]:!1},t)).useSharedArrayBuffer&&!(0,w.isSharedArrayBufferSupported)())throw Error("MeshBVH: SharedArrayBuffer is not available.");this.geometry=e,this._roots=null,this._indirectBuffer=null,t[o.SKIP_GENERATION]||((0,a.buildPackedTree)(this,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new n.Box3)));let{_indirectBuffer:r}=this;this.resolveTriangleIndex=t.indirect?e=>r[e]:e=>e}refit(e=null){return(this.indirect?h.refit_indirect:p.refit)(this,e)}traverse(e,t=0){let r=this._roots[t],n=new Uint32Array(r),i=new Uint16Array(r);(function t(a,s=0){let l=2*a,u=i[l+15]===o.IS_LEAFNODE_FLAG;if(u){let t=n[a+6],o=i[l+14];e(s,u,new Float32Array(r,4*a,6),t,o)}else{let i=a+o.BYTES_PER_NODE/4,l=n[a+6],c=n[a+7];e(s,u,new Float32Array(r,4*a,6),c)||(t(i,s+1),t(l,s+1))}})(0)}raycast(e,t=n.FrontSide){let r=this._roots,i=this.geometry,o=[],a=t.isMaterial,s=Array.isArray(t),l=i.groups,u=a?t.side:t,c=this.indirect?A.raycast_indirect:x.raycast;for(let n=0,i=r.length;n<i;n++){let r=s?t[l[n].materialIndex].side:u,i=o.length;if(c(this,n,r,e,o),s){let e=l[n].materialIndex;for(let t=i,r=o.length;t<r;t++)o[t].face.materialIndex=e}}return o}raycastFirst(e,t=n.FrontSide){let r=this._roots,i=this.geometry,o=t.isMaterial,a=Array.isArray(t),s=null,l=i.groups,u=o?t.side:t,c=this.indirect?m.raycastFirst_indirect:y.raycastFirst;for(let n=0,i=r.length;n<i;n++){let r=a?t[l[n].materialIndex].side:u,i=c(this,n,r,e);null!=i&&(null==s||i.distance<s.distance)&&(s=i,a&&(i.face.materialIndex=l[n].materialIndex))}return s}intersectsGeometry(e,t){let r=!1,n=this._roots,i=this.indirect?E.intersectsGeometry_indirect:g.intersectsGeometry;for(let o=0,a=n.length;o<a&&!(r=i(this,o,e,t));o++);return r}shapecast(e){let t=(0,u.ExtendedTrianglePool).getPrimitive(),r=this.indirect?T.iterateOverTriangles_indirect:d.iterateOverTriangles,{boundsTraverseOrder:n,intersectsBounds:i,intersectsRange:o,intersectsTriangle:a}=e;if(o&&a){let e=o;o=(n,i,o,s,l)=>!!e(n,i,o,s,l)||r(n,i,this,a,o,s,t)}else o||(o=a?(e,n,i,o)=>r(e,n,this,a,i,o,t):(e,t,r)=>r);let s=!1,l=0,f=this._roots;for(let e=0,t=f.length;e<t;e++){let t=f[e];if(s=(0,c.shapecast)(this,e,i,o,n,l))break;l+=t.byteLength}return(0,u.ExtendedTrianglePool).releasePrimitive(t),s}bvhcast(e,t,r){let{intersectsRanges:n,intersectsTriangles:i}=r,o=(0,u.ExtendedTrianglePool).getPrimitive(),a=this.geometry.index,s=this.geometry.attributes.position,l=this.indirect?e=>{let t=this.resolveTriangleIndex(e);(0,N.setTriangle)(o,3*t,a,s)}:e=>{(0,N.setTriangle)(o,3*e,a,s)},c=(0,u.ExtendedTrianglePool).getPrimitive(),f=e.geometry.index,d=e.geometry.attributes.position,p=e.indirect?t=>{let r=e.resolveTriangleIndex(t);(0,N.setTriangle)(c,3*r,f,d)}:e=>{(0,N.setTriangle)(c,3*e,f,d)};if(i){let e=(e,r,n,a,s,u,f,d)=>{for(let x=n,y=n+a;x<y;x++){p(x),c.a.applyMatrix4(t),c.b.applyMatrix4(t),c.c.applyMatrix4(t),c.needsUpdate=!0;for(let t=e,n=e+r;t<n;t++)if(l(t),o.needsUpdate=!0,i(o,c,t,x,s,u,f,d))return!0}return!1};if(n){let t=n;n=function(r,n,i,o,a,s,l,u){return!!t(r,n,i,o,a,s,l,u)||e(r,n,i,o,a,s,l,u)}}else n=e}return(0,I.bvhcast)(this,e,t,n)}intersectsBox(e,t){return S.set(e.min,e.max,t),S.needsUpdate=!0,this.shapecast({intersectsBounds:e=>S.intersectsBox(e),intersectsTriangle:e=>S.intersectsTriangle(e)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t,r={},n={},i=0,o=1/0){return(this.indirect?_.closestPointToGeometry_indirect:B.closestPointToGeometry)(this,e,t,r,n,i,o)}closestPointToPoint(e,t={},r=0,n=1/0){return(0,f.closestPointToPoint)(this,e,t,r,n)}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach(t=>{(0,l.arrayToBox)(0,new Float32Array(t),O),e.union(O)}),e}}}),o("Mleu6",function(t,r){e(t.exports,"CENTER",()=>n),e(t.exports,"AVERAGE",()=>i),e(t.exports,"SAH",()=>o),e(t.exports,"NOT_INTERSECTED",()=>a),e(t.exports,"INTERSECTED",()=>s),e(t.exports,"CONTAINED",()=>l),e(t.exports,"TRIANGLE_INTERSECT_COST",()=>u),e(t.exports,"TRAVERSAL_COST",()=>c),e(t.exports,"BYTES_PER_NODE",()=>f),e(t.exports,"IS_LEAFNODE_FLAG",()=>d),e(t.exports,"FLOAT32_EPSILON",()=>p),e(t.exports,"SKIP_GENERATION",()=>x);let n=0,i=1,o=2,a=0,s=1,l=2,u=1.25,c=1,f=32,d=65535,p=5960464477539063e-23,x=Symbol("SKIP_GENERATION")}),o("4ARWa",function(t,r){e(t.exports,"buildPackedTree",()=>d);var n=i("aBE3W"),o=i("1EkjE"),a=i("kgX4U"),s=i("43QJu"),l=i("Mleu6"),u=i("1mLHb"),c=i("7OpkL"),f=i("dxzVn");function d(e,t){let r=e.geometry;t.indirect&&(e._indirectBuffer=function(e,t){let r=(e.index?e.index.count:e.attributes.position.count)/3,n=r>65536,i=n?4:2,o=t?new SharedArrayBuffer(r*i):new ArrayBuffer(r*i),a=n?new Uint32Array(o):new Uint16Array(o);for(let e=0,t=a.length;e<t;e++)a[e]=e;return a}(r,t.useSharedArrayBuffer),(0,n.hasGroupGaps)(r)&&!t.verbose&&console.warn('MeshBVH: Provided geometry contains groups that do not fully span the vertex contents while using the "indirect" option. BVH may incorrectly report intersections on unrendered portions of the geometry.')),e._indirectBuffer||(0,n.ensureIndex)(r,t);let i=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,d=(0,o.computeTriangleBounds)(r),p=t.indirect?(0,n.getFullGeometryRange)(r):(0,n.getRootIndexRanges)(r);e._roots=p.map(r=>{let p=function(e,t,r,i,l){let{maxDepth:f,verbose:d,maxLeafTris:p,strategy:x,onProgress:y,indirect:g}=l,B=e._indirectBuffer,T=e.geometry,h=T.index?T.index.array:null,A=g?c.partition_indirect:u.partition,m=(0,n.getTriCount)(T),E=new Float32Array(6),_=!1,w=new s.MeshBVHNode;return(0,o.getBounds)(t,r,i,w.boundingData,E),function e(r,n,i,l=null,u=0){if(!_&&u>=f&&(_=!0,d&&(console.warn(`MeshBVH: Max depth of ${f} reached when generating BVH. Consider increasing maxDepth.`),console.warn(T))),i<=p||u>=f)return N(n+i),r.offset=n,r.count=i,r;let c=(0,a.getOptimalSplit)(r.boundingData,l,t,n,i,x);if(-1===c.axis)return N(n+i),r.offset=n,r.count=i,r;let y=A(B,h,t,n,i,c);if(y===n||y===n+i)N(n+i),r.offset=n,r.count=i;else{r.splitAxis=c.axis;let a=new s.MeshBVHNode,l=y-n;r.left=a,(0,o.getBounds)(t,n,l,a.boundingData,E),e(a,n,l,E,u+1);let f=new s.MeshBVHNode,d=i-l;r.right=f,(0,o.getBounds)(t,y,d,f.boundingData,E),e(f,y,d,E,u+1)}return r}(w,r,i,E),w;function N(e){y&&y(e/m)}}(e,d,r.offset,r.count,t),x=(0,f.countNodes)(p),y=new i(l.BYTES_PER_NODE*x);return(0,f.populateBuffer)(0,p,y),y})}}),o("aBE3W",function(t,r){e(t.exports,"getVertexCount",()=>o),e(t.exports,"getTriCount",()=>a),e(t.exports,"getIndexArray",()=>s),e(t.exports,"ensureIndex",()=>l),e(t.exports,"getFullGeometryRange",()=>u),e(t.exports,"getRootIndexRanges",()=>c),e(t.exports,"hasGroupGaps",()=>f);var n=i("ilwiq");function o(e){return e.index?e.index.count:e.attributes.position.count}function a(e){return o(e)/3}function s(e,t=ArrayBuffer){return e>65535?new Uint32Array(new t(4*e)):new Uint16Array(new t(2*e))}function l(e,t){if(!e.index){let r=e.attributes.position.count,i=s(r,t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer);e.setIndex(new n.BufferAttribute(i,1));for(let e=0;e<r;e++)i[e]=e}}function u(e){let t=a(e),r=e.drawRange,n=r.start/3,i=(r.start+r.count)/3,o=Math.max(0,n);return[{offset:Math.floor(o),count:Math.floor(Math.min(t,i)-o)}]}function c(e){if(!e.groups||!e.groups.length)return u(e);let t=[],r=new Set,n=e.drawRange,i=n.start/3,o=(n.start+n.count)/3;for(let t of e.groups){let e=t.start/3,n=(t.start+t.count)/3;r.add(Math.max(i,e)),r.add(Math.min(o,n))}let a=Array.from(r.values()).sort((e,t)=>e-t);for(let e=0;e<a.length-1;e++){let r=a[e],n=a[e+1];t.push({offset:Math.floor(r),count:Math.floor(n-r)})}return t}function f(e){if(0===e.groups.length)return!1;let t=a(e),r=c(e).sort((e,t)=>e.offset-t.offset),n=r[r.length-1];n.count=Math.min(t-n.offset,n.count);let i=0;return r.forEach(({count:e})=>i+=e),t!==i}}),o("1EkjE",function(t,r){e(t.exports,"getBounds",()=>a),e(t.exports,"computeTriangleBounds",()=>s);var n=i("Mleu6"),o=i("aBE3W");function a(e,t,r,n,i){let o=1/0,a=1/0,s=1/0,l=-1/0,u=-1/0,c=-1/0,f=1/0,d=1/0,p=1/0,x=-1/0,y=-1/0,g=-1/0;for(let n=6*t,i=(t+r)*6;n<i;n+=6){let t=e[n+0],r=e[n+1],i=t-r,B=t+r;i<o&&(o=i),B>l&&(l=B),t<f&&(f=t),t>x&&(x=t);let T=e[n+2],h=e[n+3],A=T-h,m=T+h;A<a&&(a=A),m>u&&(u=m),T<d&&(d=T),T>y&&(y=T);let E=e[n+4],_=e[n+5],w=E-_,N=E+_;w<s&&(s=w),N>c&&(c=N),E<p&&(p=E),E>g&&(g=E)}n[0]=o,n[1]=a,n[2]=s,n[3]=l,n[4]=u,n[5]=c,i[0]=f,i[1]=d,i[2]=p,i[3]=x,i[4]=y,i[5]=g}function s(e,t=null,r=null,i=null){let a;let s=e.attributes.position,l=e.index?e.index.array:null,u=(0,o.getTriCount)(e),c=s.normalized;null===t?(a=new Float32Array(24*u),r=0,i=u):(a=t,r=r||0,i=i||u);let f=s.array,d=s.offset||0,p=3;s.isInterleavedBufferAttribute&&(p=s.data.stride);let x=["getX","getY","getZ"];for(let e=r;e<r+i;e++){let t=3*e,r=6*e,i=t+0,o=t+1,u=t+2;l&&(i=l[i],o=l[o],u=l[u]),c||(i=i*p+d,o=o*p+d,u=u*p+d);for(let e=0;e<3;e++){let t,l,d;c?(t=s[x[e]](i),l=s[x[e]](o),d=s[x[e]](u)):(t=f[i+e],l=f[o+e],d=f[u+e]);let p=t;l<p&&(p=l),d<p&&(p=d);let y=t;l>y&&(y=l),d>y&&(y=d);let g=(y-p)/2,B=2*e;a[r+B+0]=p+g,a[r+B+1]=g+(Math.abs(p)+g)*n.FLOAT32_EPSILON}}return a}}),o("kgX4U",function(t,r){e(t.exports,"getOptimalSplit",()=>u);var n=i("aw71y"),o=i("Mleu6");let a=(e,t)=>e.candidate-t.candidate,s=Array(32).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),l=new Float32Array(6);function u(e,t,r,i,u,c){let f=-1,d=0;if(c===o.CENTER)-1!==(f=(0,n.getLongestEdgeIndex)(t))&&(d=(t[f]+t[f+3])/2);else if(c===o.AVERAGE)-1!==(f=(0,n.getLongestEdgeIndex)(e))&&(d=function(e,t,r,n){let i=0;for(let o=t,a=t+r;o<a;o++)i+=e[6*o+2*n];return i/r}(r,i,u,f));else if(c===o.SAH){let c=(0,n.computeSurfaceArea)(e),p=o.TRIANGLE_INTERSECT_COST*u,x=6*i,y=(i+u)*6;for(let e=0;e<3;e++){let i=t[e],g=(t[e+3]-i)/32;if(u<8){let t=[...s];t.length=u;let i=0;for(let o=x;o<y;o+=6,i++){let a=t[i];a.candidate=r[o+2*e],a.count=0;let{bounds:s,leftCacheBounds:l,rightCacheBounds:u}=a;for(let e=0;e<3;e++)u[e]=1/0,u[e+3]=-1/0,l[e]=1/0,l[e+3]=-1/0,s[e]=1/0,s[e+3]=-1/0;(0,n.expandByTriangleBounds)(o,r,s)}t.sort(a);let l=u;for(let e=0;e<l;e++){let r=t[e];for(;e+1<l&&t[e+1].candidate===r.candidate;)t.splice(e+1,1),l--}for(let i=x;i<y;i+=6){let o=r[i+2*e];for(let e=0;e<l;e++){let a=t[e];o>=a.candidate?(0,n.expandByTriangleBounds)(i,r,a.rightCacheBounds):((0,n.expandByTriangleBounds)(i,r,a.leftCacheBounds),a.count++)}}for(let r=0;r<l;r++){let i=t[r],a=i.count,s=u-i.count,l=i.leftCacheBounds,x=i.rightCacheBounds,y=0;0!==a&&(y=(0,n.computeSurfaceArea)(l)/c);let g=0;0!==s&&(g=(0,n.computeSurfaceArea)(x)/c);let B=o.TRAVERSAL_COST+o.TRIANGLE_INTERSECT_COST*(y*a+g*s);B<p&&(f=e,p=B,d=i.candidate)}}else{for(let e=0;e<32;e++){let t=s[e];t.count=0,t.candidate=i+g+e*g;let r=t.bounds;for(let e=0;e<3;e++)r[e]=1/0,r[e+3]=-1/0}for(let t=x;t<y;t+=6){let o=~~((r[t+2*e]-i)/g);o>=32&&(o=31);let a=s[o];a.count++,(0,n.expandByTriangleBounds)(t,r,a.bounds)}let t=s[31];(0,n.copyBounds)(t.bounds,t.rightCacheBounds);for(let e=30;e>=0;e--){let t=s[e],r=s[e+1];(0,n.unionBounds)(t.bounds,r.rightCacheBounds,t.rightCacheBounds)}let a=0;for(let t=0;t<31;t++){let r=s[t],i=r.count,x=r.bounds,y=s[t+1].rightCacheBounds;0!==i&&(0===a?(0,n.copyBounds)(x,l):(0,n.unionBounds)(x,l,l));let g=0,B=0;0!==(a+=i)&&(g=(0,n.computeSurfaceArea)(l)/c);let T=u-a;0!==T&&(B=(0,n.computeSurfaceArea)(y)/c);let h=o.TRAVERSAL_COST+o.TRIANGLE_INTERSECT_COST*(g*a+B*T);h<p&&(f=e,p=h,d=r.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${c} used.`);return{axis:f,pos:d}}}),o("aw71y",function(t,r){function n(e,t,r){return r.min.x=t[e],r.min.y=t[e+1],r.min.z=t[e+2],r.max.x=t[e+3],r.max.y=t[e+4],r.max.z=t[e+5],r}function i(e){let t=-1,r=-1/0;for(let n=0;n<3;n++){let i=e[n+3]-e[n];i>r&&(r=i,t=n)}return t}function o(e,t){t.set(e)}function a(e,t,r){let n,i;for(let o=0;o<3;o++){let a=o+3;n=e[o],i=t[o],r[o]=n<i?n:i,n=e[a],i=t[a],r[a]=n>i?n:i}}function s(e,t,r){for(let n=0;n<3;n++){let i=t[e+2*n],o=t[e+2*n+1],a=i-o,s=i+o;a<r[n]&&(r[n]=a),s>r[n+3]&&(r[n+3]=s)}}function l(e){let t=e[3]-e[0],r=e[4]-e[1],n=e[5]-e[2];return 2*(t*r+r*n+n*t)}e(t.exports,"arrayToBox",()=>n),e(t.exports,"getLongestEdgeIndex",()=>i),e(t.exports,"copyBounds",()=>o),e(t.exports,"unionBounds",()=>a),e(t.exports,"expandByTriangleBounds",()=>s),e(t.exports,"computeSurfaceArea",()=>l)}),o("43QJu",function(t,r){e(t.exports,"MeshBVHNode",()=>n);class n{constructor(){this.boundingData=new Float32Array(6)}}}),o("1mLHb",function(t,r){e(t.exports,"partition",()=>n);function n(e,t,r,n,i,o){let a=n,s=n+i-1,l=o.pos,u=2*o.axis;for(;;){for(;a<=s&&r[6*a+u]<l;)a++;for(;a<=s&&r[6*s+u]>=l;)s--;if(!(a<s))return a;for(let e=0;e<3;e++){let r=t[3*a+e];t[3*a+e]=t[3*s+e],t[3*s+e]=r}for(let e=0;e<6;e++){let t=r[6*a+e];r[6*a+e]=r[6*s+e],r[6*s+e]=t}a++,s--}}}),o("7OpkL",function(t,r){e(t.exports,"partition_indirect",()=>n);function n(e,t,r,n,i,o){let a=n,s=n+i-1,l=o.pos,u=2*o.axis;for(;;){for(;a<=s&&r[6*a+u]<l;)a++;for(;a<=s&&r[6*s+u]>=l;)s--;if(!(a<s))return a;{let t=e[a];e[a]=e[s],e[s]=t;for(let e=0;e<6;e++){let t=r[6*a+e];r[6*a+e]=r[6*s+e],r[6*s+e]=t}a++,s--}}}}),o("dxzVn",function(t,r){let n,o,a,s;e(t.exports,"countNodes",()=>function e(t){return"count"in t?1:1+e(t.left)+e(t.right)}),e(t.exports,"populateBuffer",()=>c);var l=i("Mleu6"),u=i("8kAF9");function c(e,t,r){return n=new Float32Array(r),o=new Uint32Array(r),a=new Uint16Array(r),s=new Uint8Array(r),function e(t,r){let i=t/4,c=t/2,f=r.boundingData;for(let e=0;e<6;e++)n[i+e]=f[e];if("count"in r){if(r.buffer){let e=r.buffer;s.set(new Uint8Array(e),t);for(let r=t,n=t+e.byteLength;r<n;r+=l.BYTES_PER_NODE){let e=r/2;(0,u.IS_LEAF)(e,a)||(o[r/4+6]+=i)}return t+e.byteLength}{let e=r.offset,n=r.count;return o[i+6]=e,a[c+14]=n,a[c+15]=l.IS_LEAFNODE_FLAG,t+l.BYTES_PER_NODE}}{let n;let a=r.left,s=r.right,u=r.splitAxis;if((n=e(t+l.BYTES_PER_NODE,a))/4>4294967296)throw Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return o[i+6]=n/4,n=e(n,s),o[i+7]=u,n}}(e,t)}}),o("8kAF9",function(t,r){function n(e,t){return 65535===t[e+15]}function i(e,t){return t[e+6]}function o(e,t){return t[e+14]}function a(e){return e+8}function s(e,t){return t[e+6]}function l(e,t){return t[e+7]}function u(e){return e}e(t.exports,"IS_LEAF",()=>n),e(t.exports,"OFFSET",()=>i),e(t.exports,"COUNT",()=>o),e(t.exports,"LEFT_NODE",()=>a),e(t.exports,"RIGHT_NODE",()=>s),e(t.exports,"SPLIT_AXIS",()=>l),e(t.exports,"BOUNDING_DATA_INDEX",()=>u)}),o("4ytBV",function(t,r){e(t.exports,"OrientedBox",()=>l);var n=i("ilwiq"),o=i("9wcBV"),a=i("g90Dw"),s=i("iGy84");class l{constructor(e,t,r){this.isOrientedBox=!0,this.min=new n.Vector3,this.max=new n.Vector3,this.matrix=new n.Matrix4,this.invMatrix=new n.Matrix4,this.points=Array(8).fill().map(()=>new n.Vector3),this.satAxes=[,,,].fill().map(()=>new n.Vector3),this.satBounds=[,,,].fill().map(()=>new o.SeparatingAxisBounds),this.alignedSatBounds=[,,,].fill().map(()=>new o.SeparatingAxisBounds),this.needsUpdate=!1,e&&this.min.copy(e),t&&this.max.copy(t),r&&this.matrix.copy(r)}set(e,t,r){this.min.copy(e),this.max.copy(t),this.matrix.copy(r),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}}l.prototype.update=function(){let e=this.matrix,t=this.min,r=this.max,n=this.points;for(let i=0;i<=1;i++)for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){let s=n[1*i|2*o|4*a];s.x=i?r.x:t.x,s.y=o?r.y:t.y,s.z=a?r.z:t.z,s.applyMatrix4(e)}let i=this.satBounds,o=this.satAxes,a=n[0];for(let e=0;e<3;e++){let t=o[e],r=i[e],s=n[1<<e];t.subVectors(a,s),r.setFromPoints(t,n)}let s=this.alignedSatBounds;s[0].setFromPointsField(n,"x"),s[1].setFromPointsField(n,"y"),s[2].setFromPointsField(n,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1},l.prototype.intersectsBox=function(){let e=new o.SeparatingAxisBounds;return function(t){this.needsUpdate&&this.update();let r=t.min,n=t.max,i=this.satBounds,o=this.satAxes,a=this.alignedSatBounds;if(e.min=r.x,e.max=n.x,a[0].isSeparated(e)||(e.min=r.y,e.max=n.y,a[1].isSeparated(e))||(e.min=r.z,e.max=n.z,a[2].isSeparated(e)))return!1;for(let r=0;r<3;r++){let n=o[r],a=i[r];if(e.setFromBox(n,t),a.isSeparated(e))return!1}return!0}}(),l.prototype.intersectsTriangle=function(){let e=new a.ExtendedTriangle,t=[,,,],r=new o.SeparatingAxisBounds,i=new o.SeparatingAxisBounds,s=new n.Vector3;return function(n){this.needsUpdate&&this.update(),n.isExtendedTriangle?n.needsUpdate&&n.update():(e.copy(n),e.update(),n=e);let o=this.satBounds,a=this.satAxes;t[0]=n.a,t[1]=n.b,t[2]=n.c;for(let e=0;e<3;e++){let n=o[e],i=a[e];if(r.setFromPoints(i,t),n.isSeparated(r))return!1}let l=n.satBounds,u=n.satAxes,c=this.points;for(let e=0;e<3;e++){let t=l[e],n=u[e];if(r.setFromPoints(n,c),t.isSeparated(r))return!1}for(let e=0;e<3;e++){let n=a[e];for(let e=0;e<4;e++){let o=u[e];if(s.crossVectors(n,o),r.setFromPoints(s,t),i.setFromPoints(s,c),r.isSeparated(i))return!1}}return!0}}(),l.prototype.closestPointToPoint=function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t},l.prototype.distanceToPoint=function(){let e=new n.Vector3;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),l.prototype.distanceToBox=function(){let e=["x","y","z"],t=Array(12).fill().map(()=>new n.Line3),r=Array(12).fill().map(()=>new n.Line3),i=new n.Vector3,o=new n.Vector3;return function(n,a=0,l=null,u=null){if(this.needsUpdate&&this.update(),this.intersectsBox(n))return(l||u)&&(n.getCenter(o),this.closestPointToPoint(o,i),n.closestPointToPoint(i,o),l&&l.copy(i),u&&u.copy(o)),0;let c=a*a,f=n.min,d=n.max,p=this.points,x=1/0;for(let e=0;e<8;e++){let t=p[e];o.copy(t).clamp(f,d);let r=t.distanceToSquared(o);if(r<x&&(x=r,l&&l.copy(t),u&&u.copy(o),r<c))return Math.sqrt(r)}let y=0;for(let n=0;n<3;n++)for(let i=0;i<=1;i++)for(let o=0;o<=1;o++){let a=(n+1)%3,s=(n+2)%3,l=i<<a|o<<s,u=1<<n|i<<a|o<<s,c=p[l],x=p[u];t[y].set(c,x);let g=e[n],B=e[a],T=e[s],h=r[y],A=h.start,m=h.end;A[g]=f[g],A[B]=i?f[B]:d[B],A[T]=o?f[T]:d[B],m[g]=d[g],m[B]=i?f[B]:d[B],m[T]=o?f[T]:d[B],y++}for(let e=0;e<=1;e++)for(let t=0;t<=1;t++)for(let r=0;r<=1;r++){o.x=e?d.x:f.x,o.y=t?d.y:f.y,o.z=r?d.z:f.z,this.closestPointToPoint(o,i);let n=o.distanceToSquared(i);if(n<x&&(x=n,l&&l.copy(i),u&&u.copy(o),n<c))return Math.sqrt(n)}for(let e=0;e<12;e++){let n=t[e];for(let e=0;e<12;e++){let t=r[e];(0,s.closestPointsSegmentToSegment)(n,t,i,o);let a=i.distanceToSquared(o);if(a<x&&(x=a,l&&l.copy(i),u&&u.copy(o),a<c))return Math.sqrt(a)}}return Math.sqrt(x)}}()}),o("6DMlg",function(t,r){e(t.exports,"ExtendedTrianglePool",()=>s);var n=i("g90Dw"),o=i("299oE");class a extends o.PrimitivePool{constructor(){super(()=>new n.ExtendedTriangle)}}let s=new a}),o("299oE",function(t,r){e(t.exports,"PrimitivePool",()=>n);class n{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){let e=this._primitives;return 0===e.length?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}}}),o("aPqeh",function(t,r){let n,o;e(t.exports,"shapecast",()=>x);var a=i("ilwiq"),s=i("Mleu6"),l=i("aw71y"),u=i("299oE"),c=i("8kAF9"),f=i("3x2lg");let d=[],p=new u.PrimitivePool(()=>new a.Box3);function x(e,t,r,i,a,u){n=p.getPrimitive(),o=p.getPrimitive(),d.push(n,o),(0,f.BufferStack).setBuffer(e._roots[t]);let x=function e(t,r,i,a,u=null,d=0,p=0){let{float32Array:x,uint16Array:y,uint32Array:g}=f.BufferStack,B=2*t;if((0,c.IS_LEAF)(B,y)){let e=(0,c.OFFSET)(t,g),r=(0,c.COUNT)(B,y);return(0,l.arrayToBox)((0,c.BOUNDING_DATA_INDEX)(t),x,n),a(e,r,!1,p,d+t,n)}{let B,A,m,E,_,w;let N=(0,c.LEFT_NODE)(t),I=(0,c.RIGHT_NODE)(t,g),S=N,O=I;if(u&&(m=n,E=o,(0,l.arrayToBox)((0,c.BOUNDING_DATA_INDEX)(S),x,m),(0,l.arrayToBox)((0,c.BOUNDING_DATA_INDEX)(O),x,E),B=u(m),(A=u(E))<B)){S=I,O=N;let e=B;B=A,A=e,m=E}m||(m=n,(0,l.arrayToBox)((0,c.BOUNDING_DATA_INDEX)(S),x,m));let b=i(m,(0,c.IS_LEAF)(2*S,y),B,p+1,d+S);if(b===s.CONTAINED){let e=T(S);_=a(e,h(S)-e,!0,p+1,d+S,m)}else _=b&&e(S,r,i,a,u,d,p+1);if(_)return!0;E=o,(0,l.arrayToBox)((0,c.BOUNDING_DATA_INDEX)(O),x,E);let D=i(E,(0,c.IS_LEAF)(2*O,y),A,p+1,d+O);if(D===s.CONTAINED){let e=T(O);w=a(e,h(O)-e,!0,p+1,d+O,E)}else w=D&&e(O,r,i,a,u,d,p+1);if(w)return!0;return!1;function T(e){let{uint16Array:t,uint32Array:r}=f.BufferStack,n=2*e;for(;!(0,c.IS_LEAF)(n,t);)n=2*(e=(0,c.LEFT_NODE)(e));return(0,c.OFFSET)(e,r)}function h(e){let{uint16Array:t,uint32Array:r}=f.BufferStack,n=2*e;for(;!(0,c.IS_LEAF)(n,t);)n=2*(e=(0,c.RIGHT_NODE)(e,r));return(0,c.OFFSET)(e,r)+(0,c.COUNT)(n,t)}}}(0,e.geometry,r,i,a,u);(0,f.BufferStack).clearBuffer(),p.releasePrimitive(n),p.releasePrimitive(o),d.pop(),d.pop();let y=d.length;return y>0&&(o=d[y-1],n=d[y-2]),x}}),o("3x2lg",function(t,r){e(t.exports,"BufferStack",()=>n);let n=new class{constructor(){this.float32Array=null,this.uint16Array=null,this.uint32Array=null;let e=[],t=null;this.setBuffer=r=>{t&&e.push(t),t=r,this.float32Array=new Float32Array(r),this.uint16Array=new Uint16Array(r),this.uint32Array=new Uint32Array(r)},this.clearBuffer=()=>{t=null,this.float32Array=null,this.uint16Array=null,this.uint32Array=null,0!==e.length&&this.setBuffer(e.pop())}}}}),o("38TIa",function(t,r){e(t.exports,"closestPointToPoint",()=>s);var n=i("ilwiq");let o=new n.Vector3,a=new n.Vector3;function s(e,t,r={},n=0,i=1/0){let s=n*n,l=i*i,u=1/0,c=null;if(e.shapecast({boundsTraverseOrder:e=>(o.copy(t).clamp(e.min,e.max),o.distanceToSquared(t)),intersectsBounds:(e,t,r)=>r<u&&r<l,intersectsTriangle:(e,r)=>{e.closestPointToPoint(t,o);let n=t.distanceToSquared(o);return n<u&&(a.copy(o),u=n,c=r),n<s}}),u===1/0)return null;let f=Math.sqrt(u);return r.point?r.point.copy(a):r.point=a.clone(),r.distance=f,r.faceIndex=c,r}}),o("8Nb8u",function(t,r){e(t.exports,"intersectTris",()=>a),e(t.exports,"intersectClosestTri",()=>s),e(t.exports,"iterateOverTriangles",()=>l);var n=i("aZnKr"),o=i("2GwQ0");function a(e,t,r,i,o,a){let{geometry:s,_indirectBuffer:l}=e;for(let e=i,l=i+o;e<l;e++)(0,n.intersectTri)(s,t,r,e,a)}function s(e,t,r,i,o){let{geometry:a,_indirectBuffer:s}=e,l=1/0,u=null;for(let e=i,s=i+o;e<s;e++){let i;(i=(0,n.intersectTri)(a,t,r,e))&&i.distance<l&&(u=i,l=i.distance)}return u}function l(e,t,r,n,i,a,s){let{geometry:l}=r,{index:u}=l,c=l.attributes.position;for(let r=e,l=t+e;r<l;r++){let e;if(e=r,(0,o.setTriangle)(s,3*e,u,c),s.needsUpdate=!0,n(s,e,i,a))return!0}return!1}}),o("aZnKr",function(t,r){e(t.exports,"intersectTri",()=>y);var n=i("ilwiq");let o=new n.Vector3,a=new n.Vector3,s=new n.Vector3,l=new n.Vector2,u=new n.Vector2,c=new n.Vector2,f=new n.Vector3,d=new n.Vector3,p=new n.Vector3,x=new n.Vector3;function y(e,t,r,i,y){let g=3*i,B=g+0,T=g+1,h=g+2,A=e.index;e.index&&(B=A.getX(B),T=A.getX(T),h=A.getX(h));let{position:m,normal:E,uv:_,uv1:w}=e.attributes,N=function(e,t,r,i,y,g,B,T,h){o.fromBufferAttribute(t,g),a.fromBufferAttribute(t,B),s.fromBufferAttribute(t,T);let A=null===(h===n.BackSide?e.intersectTriangle(s,a,o,!0,x):e.intersectTriangle(o,a,s,h!==n.DoubleSide,x))?null:{distance:e.origin.distanceTo(x),point:x.clone()};if(A){i&&(l.fromBufferAttribute(i,g),u.fromBufferAttribute(i,B),c.fromBufferAttribute(i,T),A.uv=(0,n.Triangle).getInterpolation(x,o,a,s,l,u,c,new n.Vector2)),y&&(l.fromBufferAttribute(y,g),u.fromBufferAttribute(y,B),c.fromBufferAttribute(y,T),A.uv1=(0,n.Triangle).getInterpolation(x,o,a,s,l,u,c,new n.Vector2)),r&&(f.fromBufferAttribute(r,g),d.fromBufferAttribute(r,B),p.fromBufferAttribute(r,T),A.normal=(0,n.Triangle).getInterpolation(x,o,a,s,f,d,p,new n.Vector3),A.normal.dot(e.direction)>0&&A.normal.multiplyScalar(-1));let t={a:g,b:B,c:T,normal:new n.Vector3,materialIndex:0};(0,n.Triangle).getNormal(o,a,s,t.normal),A.face=t,A.faceIndex=g}return A}(r,m,E,_,w,B,T,h,t);return N?(N.faceIndex=i,y&&y.push(N),N):null}}),o("2GwQ0",function(t,r){function n(e,t,r,n){let i=e.a,o=e.b,a=e.c,s=t,l=t+1,u=t+2;r&&(s=r.getX(s),l=r.getX(l),u=r.getX(u)),i.x=n.getX(s),i.y=n.getY(s),i.z=n.getZ(s),o.x=n.getX(l),o.y=n.getY(l),o.z=n.getZ(l),a.x=n.getX(u),a.y=n.getY(u),a.z=n.getZ(u)}e(t.exports,"setTriangle",()=>n),i("ilwiq")}),o("6pOPX",function(t,r){e(t.exports,"refit",()=>o);var n=i("Mleu6");function o(e,t=null){let r,i,o,a;t&&Array.isArray(t)&&(t=new Set(t));let s=e.geometry,l=s.index?s.index.array:null,u=s.attributes.position,c=0,f=e._roots;for(let e=0,s=f.length;e<s;e++)r=f[e],i=new Uint32Array(r),o=new Uint16Array(r),a=new Float32Array(r),function e(r,s,c=!1){let f=2*r;if(o[f+15]===n.IS_LEAFNODE_FLAG){let e=i[r+6],t=o[f+14],n=1/0,s=1/0,c=1/0,d=-1/0,p=-1/0,x=-1/0;for(let r=3*e,i=3*(e+t);r<i;r++){let e=l[r],t=u.getX(e),i=u.getY(e),o=u.getZ(e);t<n&&(n=t),t>d&&(d=t),i<s&&(s=i),i>p&&(p=i),o<c&&(c=o),o>x&&(x=o)}return(a[r+0]!==n||a[r+1]!==s||a[r+2]!==c||a[r+3]!==d||a[r+4]!==p||a[r+5]!==x)&&(a[r+0]=n,a[r+1]=s,a[r+2]=c,a[r+3]=d,a[r+4]=p,a[r+5]=x,!0)}{let n=r+8,o=i[r+6],l=n+s,u=o+s,f=c,d=!1,p=!1;t?f||(d=t.has(l),p=t.has(u),f=!d&&!p):(d=!0,p=!0);let x=f||d,y=f||p,g=!1;x&&(g=e(n,s,f));let B=!1;y&&(B=e(o,s,f));let T=g||B;if(T)for(let e=0;e<3;e++){let t=n+e,i=o+e,s=a[t],l=a[t+3],u=a[i],c=a[i+3];a[r+e]=s<u?s:u,a[r+e+3]=l>c?l:c}return T}}(0,c),c+=r.byteLength}}),o("01T8e",function(t,r){e(t.exports,"raycast",()=>l);var n=i("7LluF"),o=i("8kAF9"),a=i("3x2lg"),s=i("8Nb8u");function l(e,t,r,i,l){(0,a.BufferStack).setBuffer(e._roots[t]),function e(t,r,i,l,u){let{float32Array:c,uint16Array:f,uint32Array:d}=a.BufferStack,p=2*t;if((0,o.IS_LEAF)(p,f)){let e=(0,o.OFFSET)(t,d),n=(0,o.COUNT)(p,f);(0,s.intersectTris)(r,i,l,e,n,u)}else{let a=(0,o.LEFT_NODE)(t);(0,n.intersectRay)(a,c,l)&&e(a,r,i,l,u);let s=(0,o.RIGHT_NODE)(t,d);(0,n.intersectRay)(s,c,l)&&e(s,r,i,l,u)}}(0,e,r,i,l),(0,a.BufferStack).clearBuffer()}}),o("7LluF",function(t,r){e(t.exports,"intersectRay",()=>n);function n(e,t,r){let n,i,o,a,s,l;let u=1/r.direction.x,c=1/r.direction.y,f=1/r.direction.z,d=r.origin.x,p=r.origin.y,x=r.origin.z,y=t[e],g=t[e+3],B=t[e+1],T=t[e+3+1],h=t[e+2],A=t[e+3+2];return u>=0?(n=(y-d)*u,i=(g-d)*u):(n=(g-d)*u,i=(y-d)*u),c>=0?(o=(B-p)*c,a=(T-p)*c):(o=(T-p)*c,a=(B-p)*c),!(n>a)&&!(o>i)&&((o>n||isNaN(n))&&(n=o),(a<i||isNaN(i))&&(i=a),f>=0?(s=(h-x)*f,l=(A-x)*f):(s=(A-x)*f,l=(h-x)*f),!(n>l)&&!(s>i)&&((l<i||i!=i)&&(i=l),!(i<0)))}}),o("9Aami",function(t,r){e(t.exports,"raycastFirst",()=>u);var n=i("8kAF9"),o=i("3x2lg"),a=i("7LluF"),s=i("8Nb8u");let l=["x","y","z"];function u(e,t,r,i){(0,o.BufferStack).setBuffer(e._roots[t]);let u=function e(t,r,i,u){let{float32Array:c,uint16Array:f,uint32Array:d}=o.BufferStack,p=2*t;if((0,n.IS_LEAF)(p,f)){let e=(0,n.OFFSET)(t,d),o=(0,n.COUNT)(p,f);return(0,s.intersectClosestTri)(r,i,u,e,o)}{let o,s;let f=(0,n.SPLIT_AXIS)(t,d),p=l[f],x=u.direction[p]>=0;x?(o=(0,n.LEFT_NODE)(t),s=(0,n.RIGHT_NODE)(t,d)):(o=(0,n.RIGHT_NODE)(t,d),s=(0,n.LEFT_NODE)(t));let y=(0,a.intersectRay)(o,c,u)?e(o,r,i,u):null;if(y){let e=y.point[p];if(x?e<=c[s+f]:e>=c[s+f+3])return y}let g=(0,a.intersectRay)(s,c,u)?e(s,r,i,u):null;return y&&g?y.distance<=g.distance?y:g:y||g||null}}(0,e,r,i);return(0,o.BufferStack).clearBuffer(),u}}),o("iWlby",function(t,r){e(t.exports,"intersectsGeometry",()=>B);var n=i("ilwiq"),o=i("4ytBV"),a=i("g90Dw"),s=i("2GwQ0"),l=i("aw71y"),u=i("8kAF9"),c=i("3x2lg");let f=new n.Box3,d=new a.ExtendedTriangle,p=new a.ExtendedTriangle,x=new n.Matrix4,y=new o.OrientedBox,g=new o.OrientedBox;function B(e,t,r,n){(0,c.BufferStack).setBuffer(e._roots[t]);let i=function e(t,r,n,i,o=null){let{float32Array:a,uint16Array:B,uint32Array:T}=c.BufferStack,h=2*t;if(null===o&&(n.boundingBox||n.computeBoundingBox(),y.set(n.boundingBox.min,n.boundingBox.max,i),o=y),(0,u.IS_LEAF)(h,B)){let e=r.geometry,o=e.index,c=e.attributes.position,f=n.index,y=n.attributes.position,A=(0,u.OFFSET)(t,T),m=(0,u.COUNT)(h,B);if(x.copy(i).invert(),n.boundsTree)return(0,l.arrayToBox)((0,u.BOUNDING_DATA_INDEX)(t),a,g),g.matrix.copy(x),g.needsUpdate=!0,n.boundsTree.shapecast({intersectsBounds:e=>g.intersectsBox(e),intersectsTriangle:e=>{e.a.applyMatrix4(i),e.b.applyMatrix4(i),e.c.applyMatrix4(i),e.needsUpdate=!0;for(let t=3*A,r=(m+A)*3;t<r;t+=3)if((0,s.setTriangle)(p,t,o,c),p.needsUpdate=!0,e.intersectsTriangle(p))return!0;return!1}});for(let e=3*A,t=(m+A)*3;e<t;e+=3){(0,s.setTriangle)(d,e,o,c),d.a.applyMatrix4(x),d.b.applyMatrix4(x),d.c.applyMatrix4(x),d.needsUpdate=!0;for(let e=0,t=f.count;e<t;e+=3)if((0,s.setTriangle)(p,e,f,y),p.needsUpdate=!0,d.intersectsTriangle(p))return!0}}else{let s=t+8,c=T[t+6];return(0,l.arrayToBox)((0,u.BOUNDING_DATA_INDEX)(s),a,f),!!(o.intersectsBox(f)&&e(s,r,n,i,o))||((0,l.arrayToBox)((0,u.BOUNDING_DATA_INDEX)(c),a,f),!!(o.intersectsBox(f)&&e(c,r,n,i,o)))}}(0,e,r,n);return(0,c.BufferStack).clearBuffer(),i}}),o("hKG28",function(t,r){e(t.exports,"closestPointToGeometry",()=>g);var n=i("ilwiq"),o=i("4ytBV"),a=i("2GwQ0"),s=i("aBE3W"),l=i("6DMlg");let u=new n.Matrix4,c=new o.OrientedBox,f=new o.OrientedBox,d=new n.Vector3,p=new n.Vector3,x=new n.Vector3,y=new n.Vector3;function g(e,t,r,n={},i={},o=0,g=1/0){t.boundingBox||t.computeBoundingBox(),c.set(t.boundingBox.min,t.boundingBox.max,r),c.needsUpdate=!0;let B=e.geometry,T=B.attributes.position,h=B.index,A=t.attributes.position,m=t.index,E=(0,l.ExtendedTrianglePool).getPrimitive(),_=(0,l.ExtendedTrianglePool).getPrimitive(),w=null,N=null;i&&(w=x,N=y);let I=1/0,S=null,O=null;return(u.copy(r).invert(),f.matrix.copy(u),e.shapecast({boundsTraverseOrder:e=>c.distanceToBox(e),intersectsBounds:(e,t,r)=>r<I&&r<g&&(t&&(f.min.copy(e.min),f.max.copy(e.max),f.needsUpdate=!0),!0),intersectsRange:(e,n)=>{if(t.boundsTree)return t.boundsTree.shapecast({boundsTraverseOrder:e=>f.distanceToBox(e),intersectsBounds:(e,t,r)=>r<I&&r<g,intersectsRange:(t,i)=>{for(let s=t,l=t+i;s<l;s++){(0,a.setTriangle)(_,3*s,m,A),_.a.applyMatrix4(r),_.b.applyMatrix4(r),_.c.applyMatrix4(r),_.needsUpdate=!0;for(let t=e,r=e+n;t<r;t++){(0,a.setTriangle)(E,3*t,h,T),E.needsUpdate=!0;let e=E.distanceToTriangle(_,d,w);if(e<I&&(p.copy(d),N&&N.copy(w),I=e,S=t,O=s),e<o)return!0}}}});{let i=(0,s.getTriCount)(t);for(let t=0;t<i;t++){(0,a.setTriangle)(_,3*t,m,A),_.a.applyMatrix4(r),_.b.applyMatrix4(r),_.c.applyMatrix4(r),_.needsUpdate=!0;for(let r=e,i=e+n;r<i;r++){(0,a.setTriangle)(E,3*r,h,T),E.needsUpdate=!0;let e=E.distanceToTriangle(_,d,w);if(e<I&&(p.copy(d),N&&N.copy(w),I=e,S=r,O=t),e<o)return!0}}}}}),(0,l.ExtendedTrianglePool).releasePrimitive(E),(0,l.ExtendedTrianglePool).releasePrimitive(_),I===1/0)?null:(n.point?n.point.copy(p):n.point=p.clone(),n.distance=I,n.faceIndex=S,i&&(i.point?i.point.copy(N):i.point=N.clone(),i.point.applyMatrix4(u),p.applyMatrix4(u),i.distance=p.sub(i.point).length(),i.faceIndex=O),n)}}),o("jRigT",function(t,r){e(t.exports,"intersectTris_indirect",()=>a),e(t.exports,"intersectClosestTri_indirect",()=>s),e(t.exports,"iterateOverTriangles_indirect",()=>l);var n=i("aZnKr"),o=i("2GwQ0");function a(e,t,r,i,o,a){let{geometry:s,_indirectBuffer:l}=e;for(let e=i,u=i+o;e<u;e++){let i=l?l[e]:e;(0,n.intersectTri)(s,t,r,i,a)}}function s(e,t,r,i,o){let{geometry:a,_indirectBuffer:s}=e,l=1/0,u=null;for(let e=i,c=i+o;e<c;e++){let i;(i=(0,n.intersectTri)(a,t,r,s?s[e]:e))&&i.distance<l&&(u=i,l=i.distance)}return u}function l(e,t,r,n,i,a,s){let{geometry:l}=r,{index:u}=l,c=l.attributes.position;for(let l=e,f=t+e;l<f;l++){let e;if(e=r.resolveTriangleIndex(l),(0,o.setTriangle)(s,3*e,u,c),s.needsUpdate=!0,n(s,e,i,a))return!0}return!1}}),o("fRYTF",function(t,r){e(t.exports,"refit_indirect",()=>o);var n=i("Mleu6");function o(e,t=null){let r,i,o,a;t&&Array.isArray(t)&&(t=new Set(t));let s=e.geometry,l=s.index?s.index.array:null,u=s.attributes.position,c=0,f=e._roots;for(let s=0,d=f.length;s<d;s++)r=f[s],i=new Uint32Array(r),o=new Uint16Array(r),a=new Float32Array(r),function r(s,c,f=!1){let d=2*s;if(o[d+15]===n.IS_LEAFNODE_FLAG){let t=i[s+6],r=o[d+14],n=1/0,c=1/0,f=1/0,p=-1/0,x=-1/0,y=-1/0;for(let i=t,o=t+r;i<o;i++){let t=3*e.resolveTriangleIndex(i);for(let e=0;e<3;e++){let r=t+e;r=l?l[r]:r;let i=u.getX(r),o=u.getY(r),a=u.getZ(r);i<n&&(n=i),i>p&&(p=i),o<c&&(c=o),o>x&&(x=o),a<f&&(f=a),a>y&&(y=a)}}return(a[s+0]!==n||a[s+1]!==c||a[s+2]!==f||a[s+3]!==p||a[s+4]!==x||a[s+5]!==y)&&(a[s+0]=n,a[s+1]=c,a[s+2]=f,a[s+3]=p,a[s+4]=x,a[s+5]=y,!0)}{let e=s+8,n=i[s+6],o=e+c,l=n+c,u=f,d=!1,p=!1;t?u||(d=t.has(o),p=t.has(l),u=!d&&!p):(d=!0,p=!0);let x=u||d,y=u||p,g=!1;x&&(g=r(e,c,u));let B=!1;y&&(B=r(n,c,u));let T=g||B;if(T)for(let t=0;t<3;t++){let r=e+t,i=n+t,o=a[r],l=a[r+3],u=a[i],c=a[i+3];a[s+t]=o<u?o:u,a[s+t+3]=l>c?l:c}return T}}(0,c),c+=r.byteLength}}),o("6O8bC",function(t,r){e(t.exports,"raycast_indirect",()=>l);var n=i("7LluF"),o=i("8kAF9"),a=i("3x2lg"),s=i("jRigT");function l(e,t,r,i,l){(0,a.BufferStack).setBuffer(e._roots[t]),function e(t,r,i,l,u){let{float32Array:c,uint16Array:f,uint32Array:d}=a.BufferStack,p=2*t;if((0,o.IS_LEAF)(p,f)){let e=(0,o.OFFSET)(t,d),n=(0,o.COUNT)(p,f);(0,s.intersectTris_indirect)(r,i,l,e,n,u)}else{let a=(0,o.LEFT_NODE)(t);(0,n.intersectRay)(a,c,l)&&e(a,r,i,l,u);let s=(0,o.RIGHT_NODE)(t,d);(0,n.intersectRay)(s,c,l)&&e(s,r,i,l,u)}}(0,e,r,i,l),(0,a.BufferStack).clearBuffer()}}),o("cmjuj",function(t,r){e(t.exports,"raycastFirst_indirect",()=>u);var n=i("8kAF9"),o=i("3x2lg"),a=i("7LluF"),s=i("jRigT");let l=["x","y","z"];function u(e,t,r,i){(0,o.BufferStack).setBuffer(e._roots[t]);let u=function e(t,r,i,u){let{float32Array:c,uint16Array:f,uint32Array:d}=o.BufferStack,p=2*t;if((0,n.IS_LEAF)(p,f)){let e=(0,n.OFFSET)(t,d),o=(0,n.COUNT)(p,f);return(0,s.intersectClosestTri_indirect)(r,i,u,e,o)}{let o,s;let f=(0,n.SPLIT_AXIS)(t,d),p=l[f],x=u.direction[p]>=0;x?(o=(0,n.LEFT_NODE)(t),s=(0,n.RIGHT_NODE)(t,d)):(o=(0,n.RIGHT_NODE)(t,d),s=(0,n.LEFT_NODE)(t));let y=(0,a.intersectRay)(o,c,u)?e(o,r,i,u):null;if(y){let e=y.point[p];if(x?e<=c[s+f]:e>=c[s+f+3])return y}let g=(0,a.intersectRay)(s,c,u)?e(s,r,i,u):null;return y&&g?y.distance<=g.distance?y:g:y||g||null}}(0,e,r,i);return(0,o.BufferStack).clearBuffer(),u}}),o("7rVal",function(t,r){e(t.exports,"intersectsGeometry_indirect",()=>B);var n=i("ilwiq"),o=i("4ytBV"),a=i("g90Dw"),s=i("2GwQ0"),l=i("aw71y"),u=i("8kAF9"),c=i("3x2lg");let f=new n.Box3,d=new a.ExtendedTriangle,p=new a.ExtendedTriangle,x=new n.Matrix4,y=new o.OrientedBox,g=new o.OrientedBox;function B(e,t,r,n){(0,c.BufferStack).setBuffer(e._roots[t]);let i=function e(t,r,n,i,o=null){let{float32Array:a,uint16Array:B,uint32Array:T}=c.BufferStack,h=2*t;if(null===o&&(n.boundingBox||n.computeBoundingBox(),y.set(n.boundingBox.min,n.boundingBox.max,i),o=y),(0,u.IS_LEAF)(h,B)){let e=r.geometry,o=e.index,c=e.attributes.position,f=n.index,y=n.attributes.position,A=(0,u.OFFSET)(t,T),m=(0,u.COUNT)(h,B);if(x.copy(i).invert(),n.boundsTree)return(0,l.arrayToBox)((0,u.BOUNDING_DATA_INDEX)(t),a,g),g.matrix.copy(x),g.needsUpdate=!0,n.boundsTree.shapecast({intersectsBounds:e=>g.intersectsBox(e),intersectsTriangle:e=>{e.a.applyMatrix4(i),e.b.applyMatrix4(i),e.c.applyMatrix4(i),e.needsUpdate=!0;for(let t=A,n=m+A;t<n;t++)if((0,s.setTriangle)(p,3*r.resolveTriangleIndex(t),o,c),p.needsUpdate=!0,e.intersectsTriangle(p))return!0;return!1}});for(let e=A,t=m+A;e<t;e++){let t=r.resolveTriangleIndex(e);(0,s.setTriangle)(d,3*t,o,c),d.a.applyMatrix4(x),d.b.applyMatrix4(x),d.c.applyMatrix4(x),d.needsUpdate=!0;for(let e=0,t=f.count;e<t;e+=3)if((0,s.setTriangle)(p,e,f,y),p.needsUpdate=!0,d.intersectsTriangle(p))return!0}}else{let s=t+8,c=T[t+6];return(0,l.arrayToBox)((0,u.BOUNDING_DATA_INDEX)(s),a,f),!!(o.intersectsBox(f)&&e(s,r,n,i,o))||((0,l.arrayToBox)((0,u.BOUNDING_DATA_INDEX)(c),a,f),!!(o.intersectsBox(f)&&e(c,r,n,i,o)))}}(0,e,r,n);return(0,c.BufferStack).clearBuffer(),i}}),o("ipmev",function(t,r){e(t.exports,"closestPointToGeometry_indirect",()=>g);var n=i("ilwiq"),o=i("4ytBV"),a=i("2GwQ0"),s=i("aBE3W"),l=i("6DMlg");let u=new n.Matrix4,c=new o.OrientedBox,f=new o.OrientedBox,d=new n.Vector3,p=new n.Vector3,x=new n.Vector3,y=new n.Vector3;function g(e,t,r,n={},i={},o=0,g=1/0){t.boundingBox||t.computeBoundingBox(),c.set(t.boundingBox.min,t.boundingBox.max,r),c.needsUpdate=!0;let B=e.geometry,T=B.attributes.position,h=B.index,A=t.attributes.position,m=t.index,E=(0,l.ExtendedTrianglePool).getPrimitive(),_=(0,l.ExtendedTrianglePool).getPrimitive(),w=null,N=null;i&&(w=x,N=y);let I=1/0,S=null,O=null;return(u.copy(r).invert(),f.matrix.copy(u),e.shapecast({boundsTraverseOrder:e=>c.distanceToBox(e),intersectsBounds:(e,t,r)=>r<I&&r<g&&(t&&(f.min.copy(e.min),f.max.copy(e.max),f.needsUpdate=!0),!0),intersectsRange:(n,i)=>{if(t.boundsTree){let s=t.boundsTree;return s.shapecast({boundsTraverseOrder:e=>f.distanceToBox(e),intersectsBounds:(e,t,r)=>r<I&&r<g,intersectsRange:(t,l)=>{for(let u=t,c=t+l;u<c;u++){let t=s.resolveTriangleIndex(u);(0,a.setTriangle)(_,3*t,m,A),_.a.applyMatrix4(r),_.b.applyMatrix4(r),_.c.applyMatrix4(r),_.needsUpdate=!0;for(let t=n,r=n+i;t<r;t++){let r=e.resolveTriangleIndex(t);(0,a.setTriangle)(E,3*r,h,T),E.needsUpdate=!0;let n=E.distanceToTriangle(_,d,w);if(n<I&&(p.copy(d),N&&N.copy(w),I=n,S=t,O=u),n<o)return!0}}}})}{let l=(0,s.getTriCount)(t);for(let t=0;t<l;t++){(0,a.setTriangle)(_,3*t,m,A),_.a.applyMatrix4(r),_.b.applyMatrix4(r),_.c.applyMatrix4(r),_.needsUpdate=!0;for(let r=n,s=n+i;r<s;r++){let n=e.resolveTriangleIndex(r);(0,a.setTriangle)(E,3*n,h,T),E.needsUpdate=!0;let i=E.distanceToTriangle(_,d,w);if(i<I&&(p.copy(d),N&&N.copy(w),I=i,S=r,O=t),i<o)return!0}}}}}),(0,l.ExtendedTrianglePool).releasePrimitive(E),(0,l.ExtendedTrianglePool).releasePrimitive(_),I===1/0)?null:(n.point?n.point.copy(p):n.point=p.clone(),n.distance=I,n.faceIndex=S,i&&(i.point?i.point.copy(N):i.point=N.clone(),i.point.applyMatrix4(u),p.applyMatrix4(u),i.distance=p.sub(i.point).length(),i.faceIndex=O),n)}}),o("2zRsl",function(t,r){function n(){return"undefined"!=typeof SharedArrayBuffer}function i(e,t){if(null===e)return e;if(e.buffer){let r=e.buffer;if(r.constructor===t)return e;let n=new e.constructor(new t(r.byteLength));return n.set(e),n}{if(e.constructor===t)return e;let r=new t(e.byteLength);return new Uint8Array(r).set(new Uint8Array(e)),r}}e(t.exports,"isSharedArrayBufferSupported",()=>n),e(t.exports,"convertToBufferType",()=>i)}),o("eLAt7",function(t,r){e(t.exports,"bvhcast",()=>B);var n=i("ilwiq"),o=i("3x2lg"),a=i("8kAF9"),s=i("aw71y"),l=i("299oE");let u=new o.BufferStack.constructor,c=new o.BufferStack.constructor,f=new l.PrimitivePool(()=>new n.Box3),d=new n.Box3,p=new n.Box3,x=new n.Box3,y=new n.Box3,g=!1;function B(e,t,r,i){let o;if(g)throw Error("MeshBVH: Recursive calls to bvhcast not supported.");g=!0;let l=e._roots,B=t._roots,T=0,h=0,A=new(0,n.Matrix4)().copy(r).invert();for(let e=0,t=l.length;e<t;e++){u.setBuffer(l[e]),h=0;let t=f.getPrimitive();(0,s.arrayToBox)((0,a.BOUNDING_DATA_INDEX)(0),u.float32Array,t),t.applyMatrix4(A);for(let n=0,l=B.length;n<l&&(c.setBuffer(B[e]),o=function e(t,r,n,i,o,l=0,g=0,B=0,T=0,h=null,A=!1){let m,E;A?(m=c,E=u):(m=u,E=c);let _=m.float32Array,w=m.uint32Array,N=m.uint16Array,I=E.float32Array,S=E.uint32Array,O=E.uint16Array,b=2*t,D=2*r,F=(0,a.IS_LEAF)(b,N),v=(0,a.IS_LEAF)(D,O),P=!1;if(v&&F)P=A?o((0,a.OFFSET)(r,S),(0,a.COUNT)(2*r,O),(0,a.OFFSET)(t,w),(0,a.COUNT)(2*t,N),T,g+r,B,l+t):o((0,a.OFFSET)(t,w),(0,a.COUNT)(2*t,N),(0,a.OFFSET)(r,S),(0,a.COUNT)(2*r,O),B,l+t,T,g+r);else if(v){let u=f.getPrimitive();(0,s.arrayToBox)((0,a.BOUNDING_DATA_INDEX)(r),I,u),u.applyMatrix4(n);let c=(0,a.LEFT_NODE)(t),x=(0,a.RIGHT_NODE)(t,w);(0,s.arrayToBox)((0,a.BOUNDING_DATA_INDEX)(c),_,d),(0,s.arrayToBox)((0,a.BOUNDING_DATA_INDEX)(x),_,p);let y=u.intersectsBox(d),h=u.intersectsBox(p);P=y&&e(r,c,i,n,o,g,l,T,B+1,u,!A)||h&&e(r,x,i,n,o,g,l,T,B+1,u,!A),f.releasePrimitive(u)}else{let u=(0,a.LEFT_NODE)(r),c=(0,a.RIGHT_NODE)(r,S);(0,s.arrayToBox)((0,a.BOUNDING_DATA_INDEX)(u),I,x),(0,s.arrayToBox)((0,a.BOUNDING_DATA_INDEX)(c),I,y);let m=h.intersectsBox(x),E=h.intersectsBox(y);if(m&&E)P=e(t,u,n,i,o,l,g,B,T+1,h,A)||e(t,c,n,i,o,l,g,B,T+1,h,A);else if(m){if(F)P=e(t,u,n,i,o,l,g,B,T+1,h,A);else{let r=f.getPrimitive();r.copy(x).applyMatrix4(n);let c=(0,a.LEFT_NODE)(t),y=(0,a.RIGHT_NODE)(t,w);(0,s.arrayToBox)((0,a.BOUNDING_DATA_INDEX)(c),_,d),(0,s.arrayToBox)((0,a.BOUNDING_DATA_INDEX)(y),_,p);let h=r.intersectsBox(d),m=r.intersectsBox(p);P=h&&e(u,c,i,n,o,g,l,T,B+1,r,!A)||m&&e(u,y,i,n,o,g,l,T,B+1,r,!A),f.releasePrimitive(r)}}else if(E){if(F)P=e(t,c,n,i,o,l,g,B,T+1,h,A);else{let r=f.getPrimitive();r.copy(y).applyMatrix4(n);let u=(0,a.LEFT_NODE)(t),x=(0,a.RIGHT_NODE)(t,w);(0,s.arrayToBox)((0,a.BOUNDING_DATA_INDEX)(u),_,d),(0,s.arrayToBox)((0,a.BOUNDING_DATA_INDEX)(x),_,p);let h=r.intersectsBox(d),m=r.intersectsBox(p);P=h&&e(c,u,i,n,o,g,l,T,B+1,r,!A)||m&&e(c,x,i,n,o,g,l,T,B+1,r,!A),f.releasePrimitive(r)}}}return P}(0,0,r,A,i,T,h,0,0,t),c.clearBuffer(),h+=B[n].length,!o);n++);if(f.releasePrimitive(t),u.clearBuffer(),T+=l[e].length,o)break}return g=!1,o}});
//# sourceMappingURL=asyncGenerate.77ce35af.js.map
