let e,t,a,i,r,s,n,o,l,d,p;function h(e,t,a,i){Object.defineProperty(e,t,{get:a,set:i,enumerable:!0,configurable:!0})}var c=globalThis,u={},y={},m=c.parcelRequire4485;null==m&&((m=function(e){if(e in u)return u[e].exports;if(e in y){var t=y[e];delete y[e];var a={id:e,exports:{}};return u[e]=a,t.call(a.exports,a,a.exports),a.exports}var i=Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){y[e]=t},c.parcelRequire4485=m);var w=m.register;w("apoN1",function(e,t){h(e.exports,"RoundedBoxGeometry",()=>s);var a=m("ilwiq");let i=new a.Vector3;function r(e,t,a,r,s,n){let o=2*Math.PI*s/4,l=Math.max(n-2*s,0);i.copy(t),i[r]=0,i.normalize();let d=.5*o/(o+l),p=1-i.angleTo(e)/(Math.PI/4);return 1===Math.sign(i[a])?p*d:l/(o+l)+d+d*(1-p)}class s extends a.BoxGeometry{constructor(e=1,t=1,i=1,s=2,n=.1){if(s=2*s+1,n=Math.min(e/2,t/2,i/2,n),super(1,1,1,s,s,s),1===s)return;let o=this.toNonIndexed();this.index=null,this.attributes.position=o.attributes.position,this.attributes.normal=o.attributes.normal,this.attributes.uv=o.attributes.uv;let l=new a.Vector3,d=new a.Vector3,p=new(0,a.Vector3)(e,t,i).divideScalar(2).subScalar(n),h=this.attributes.position.array,c=this.attributes.normal.array,u=this.attributes.uv.array,y=h.length/6,m=new a.Vector3,w=.5/s;for(let a=0,s=0;a<h.length;a+=3,s+=2)switch(l.fromArray(h,a),d.copy(l),d.x-=Math.sign(d.x)*w,d.y-=Math.sign(d.y)*w,d.z-=Math.sign(d.z)*w,d.normalize(),h[a+0]=p.x*Math.sign(l.x)+d.x*n,h[a+1]=p.y*Math.sign(l.y)+d.y*n,h[a+2]=p.z*Math.sign(l.z)+d.z*n,c[a+0]=d.x,c[a+1]=d.y,c[a+2]=d.z,Math.floor(a/y)){case 0:m.set(1,0,0),u[s+0]=r(m,d,"z","y",n,i),u[s+1]=1-r(m,d,"y","z",n,t);break;case 1:m.set(-1,0,0),u[s+0]=1-r(m,d,"z","y",n,i),u[s+1]=1-r(m,d,"y","z",n,t);break;case 2:m.set(0,1,0),u[s+0]=1-r(m,d,"x","z",n,e),u[s+1]=r(m,d,"z","x",n,i);break;case 3:m.set(0,-1,0),u[s+0]=1-r(m,d,"x","z",n,e),u[s+1]=1-r(m,d,"z","x",n,i);break;case 4:m.set(0,0,1),u[s+0]=1-r(m,d,"x","y",n,e),u[s+1]=1-r(m,d,"y","x",n,t);break;case 5:m.set(0,0,-1),u[s+0]=r(m,d,"x","y",n,e),u[s+1]=1-r(m,d,"y","x",n,t)}}}}),w("c8CJQ",function(e,t){var a;e.exports,e.exports=((a=function(){function e(e){return r.appendChild(e.dom),e}function t(e){for(var t=0;t<r.children.length;t++)r.children[t].style.display=t===e?"block":"none";i=e}var i=0,r=document.createElement("div");r.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",r.addEventListener("click",function(e){e.preventDefault(),t(++i%r.children.length)},!1);var s=(performance||Date).now(),n=s,o=0,l=e(new a.Panel("FPS","#0ff","#002")),d=e(new a.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var p=e(new a.Panel("MB","#f08","#201"));return t(0),{REVISION:16,dom:r,addPanel:e,showPanel:t,begin:function(){s=(performance||Date).now()},end:function(){o++;var e=(performance||Date).now();if(d.update(e-s,200),e>n+1e3&&(l.update(1e3*o/(e-n),100),n=e,o=0,p)){var t=performance.memory;p.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){s=this.end()},domElement:r,setMode:t}}).Panel=function(e,t,a){var i=1/0,r=0,s=Math.round,n=s(window.devicePixelRatio||1),o=80*n,l=48*n,d=3*n,p=2*n,h=3*n,c=15*n,u=74*n,y=30*n,m=document.createElement("canvas");m.width=o,m.height=l,m.style.cssText="width:80px;height:48px";var w=m.getContext("2d");return w.font="bold "+9*n+"px Helvetica,Arial,sans-serif",w.textBaseline="top",w.fillStyle=a,w.fillRect(0,0,o,l),w.fillStyle=t,w.fillText(e,d,p),w.fillRect(h,c,u,y),w.fillStyle=a,w.globalAlpha=.9,w.fillRect(h,c,u,y),{dom:m,update:function(l,f){i=Math.min(i,l),r=Math.max(r,l),w.fillStyle=a,w.globalAlpha=1,w.fillRect(0,0,o,c),w.fillStyle=t,w.fillText(s(l)+" "+e+" ("+s(i)+"-"+s(r)+")",d,p),w.drawImage(m,h+n,c,u-n,y,h,c,u-n,y),w.fillRect(h+u-n,c,n,y),w.fillStyle=a,w.globalAlpha=.9,w.fillRect(h+u-n,c,n,s((1-l/f)*y))}}},a)}),w("5ca9G",function(e,t){h(e.exports,"MeshBVHHelper",()=>o);var a=m("ilwiq"),i=m("aw71y"),r=m("ff8ed");let s=new a.Box3;class n extends a.Object3D{get isMesh(){return!this.displayEdges}get isLineSegments(){return this.displayEdges}get isLine(){return this.displayEdges}constructor(e,t,i=10,r=0){super(),this.material=t,this.geometry=new a.BufferGeometry,this.name="MeshBVHRootHelper",this.depth=i,this.displayParents=!1,this.bvh=e,this.displayEdges=!0,this._group=r}raycast(){}update(){let e=this.geometry,t=this.bvh,r=this._group;if(e.dispose(),this.visible=!1,t){let n,o;let l=this.depth-1,d=this.displayParents,p=0;t.traverse((e,t)=>{if(e>=l||t)return p++,!0;d&&p++},r);let h=0,c=new Float32Array(24*p);t.traverse((e,t,a)=>{let r=e>=l||t;if(r||d){(0,i.arrayToBox)(0,a,s);let{min:e,max:t}=s;for(let a=-1;a<=1;a+=2){let i=a<0?e.x:t.x;for(let a=-1;a<=1;a+=2){let r=a<0?e.y:t.y;for(let a=-1;a<=1;a+=2){let s=a<0?e.z:t.z;c[h+0]=i,c[h+1]=r,c[h+2]=s,h+=3}}}return r}},r),o=new Uint8Array(this.displayEdges?[0,4,1,5,2,6,3,7,0,2,1,3,4,6,5,7,0,1,2,3,4,5,6,7]:[0,1,2,2,1,3,4,6,5,6,7,5,1,4,5,0,4,1,2,3,6,3,7,6,0,2,4,2,6,4,1,5,3,3,5,7]),n=c.length>65535?new Uint32Array(o.length*p):new Uint16Array(o.length*p);let u=o.length;for(let e=0;e<p;e++){let t=8*e,a=e*u;for(let e=0;e<u;e++)n[a+e]=t+o[e]}e.setIndex(new a.BufferAttribute(n,1,!1)),e.setAttribute("position",new a.BufferAttribute(c,3,!1)),this.visible=!0}}}class o extends a.Group{get color(){return this.edgeMaterial.color}get opacity(){return this.edgeMaterial.opacity}set opacity(e){this.edgeMaterial.opacity=e,this.meshMaterial.opacity=e}constructor(e=null,t=null,i=10){e instanceof r.MeshBVH&&(i=t||10,t=e,e=null),"number"==typeof t&&(i=t,t=null),super(),this.name="MeshBVHHelper",this.depth=i,this.mesh=e,this.bvh=t,this.displayParents=!1,this.displayEdges=!0,this._roots=[];let s=new a.LineBasicMaterial({color:65416,transparent:!0,opacity:.3,depthWrite:!1}),n=new a.MeshBasicMaterial({color:65416,transparent:!0,opacity:.3,depthWrite:!1});n.color=s.color,this.edgeMaterial=s,this.meshMaterial=n,this.update()}update(){let e=this.bvh||this.mesh.geometry.boundsTree,t=e?e._roots.length:0;for(;this._roots.length>t;){let e=this._roots.pop();e.geometry.dispose(),this.remove(e)}for(let a=0;a<t;a++){let{depth:t,edgeMaterial:i,meshMaterial:r,displayParents:s,displayEdges:o}=this;if(a>=this._roots.length){let r=new n(e,i,t,a);this.add(r),this._roots.push(r)}let l=this._roots[a];l.bvh=e,l.depth=t,l.displayParents=s,l.displayEdges=o,l.material=o?i:r,l.update()}}updateMatrixWorld(...e){let t=this.mesh,a=this.parent;null!==t&&(t.updateWorldMatrix(!0,!1),a?this.matrix.copy(a.matrixWorld).invert().multiply(t.matrixWorld):this.matrix.copy(t.matrixWorld),this.matrix.decompose(this.position,this.quaternion,this.scale)),super.updateMatrixWorld(...e)}copy(e){this.depth=e.depth,this.mesh=e.mesh,this.bvh=e.bvh,this.opacity=e.opacity,this.color.copy(e.color)}clone(){return new o(this.mesh,this.bvh,this.depth)}dispose(){this.edgeMaterial.dispose(),this.meshMaterial.dispose();let e=this.children;for(let t=0,a=e.length;t<a;t++)e[t].geometry.dispose()}}});var f=m("ilwiq"),g=m("apoN1"),x=m("7lx9d"),M=m("5Rd1x"),b=m("7ePFa"),v=m("c8CJQ"),S=m("jiuw3"),z=m("ff8ed"),P=m("5ca9G"),B=m("jAT47");const V={firstPerson:!1,displayCollider:!1,displayBVH:!1,visualizeDepth:10,gravity:-30,playerSpeed:10,physicsSteps:5,reset:I};let A=!1,E=!1,C=!1,H=!1,W=!1,k=new f.Vector3,D=new f.Vector3(0,1,0),R=new f.Vector3,_=new f.Vector3,G=new f.Box3,L=new f.Matrix4,T=new f.Line3;function I(){k.set(0,0,0),d.position.set(15.75,-3,30),t.position.sub(p.target),p.target.copy(d.position),t.position.add(d.position),p.update()}(function(){(e=new f.WebGLRenderer({antialias:!0})).setPixelRatio(window.devicePixelRatio),e.setSize(window.innerWidth,window.innerHeight),e.setClearColor(1251612,1),e.shadowMap.enabled=!0,e.shadowMap.type=f.PCFSoftShadowMap,e.outputEncoding=f.sRGBEncoding,document.body.appendChild(e.domElement),(a=new f.Scene).fog=new f.Fog(1251612,20,70);let h=new f.DirectionalLight(16777215,1);h.position.set(1,1.5,1).multiplyScalar(50),h.shadow.mapSize.setScalar(2048),h.shadow.bias=-.0001,h.shadow.normalBias=.05,h.castShadow=!0;let c=h.shadow.camera;c.bottom=c.left=-30,c.top=30,c.right=45,a.add(h),a.add(new f.HemisphereLight(16777215,2241348,.4)),(t=new f.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,50)).position.set(10,10,-10),t.far=100,t.updateProjectionMatrix(),window.camera=t,i=new f.Clock,p=new M.OrbitControls(t,e.domElement),s=new(v&&v.__esModule?v.default:v),document.body.appendChild(s.dom),new(0,x.GLTFLoader)().load("../models/dungeon_low_poly_game_level_challenge/scene.gltf",e=>{let t=e.scene;t.scale.setScalar(.01);let i=new f.Box3;i.setFromObject(t),i.getCenter(t.position).negate(),t.updateMatrixWorld(!0);let r={};for(let e in t.traverse(e=>{if(!(/Boss/.test(e.name)||/Enemie/.test(e.name)||/Shield/.test(e.name)||/Sword/.test(e.name)||/Character/.test(e.name)||/Gate/.test(e.name)||/Cube/.test(e.name))&&(!e.material||1!==e.material.color.r)&&e.isMesh){let t=e.material.color.getHex();r[t]=r[t]||[],r[t].push(e)}}),n=new f.Group,r){let t=r[e],a=[];if(t.forEach(e=>{if(0!==e.material.emissive.r)n.attach(e);else{let t=e.geometry.clone();t.applyMatrix4(e.matrixWorld),a.push(t)}}),a.length){let t=b.mergeBufferGeometries(a),i=new f.Mesh(t,new f.MeshStandardMaterial({color:parseInt(e),shadowSide:2}));i.castShadow=!0,i.receiveShadow=!0,i.material.shadowSide=2,n.add(i)}}let s=new B.StaticGeometryGenerator(n);s.attributes=["position"];let d=s.generate();d.boundsTree=new z.MeshBVH(d),(o=new f.Mesh(d)).material.wireframe=!0,o.material.opacity=.5,o.material.transparent=!0,l=new P.MeshBVHHelper(o,V.visualizeDepth),a.add(l),a.add(o),a.add(n)}),(d=new f.Mesh(new g.RoundedBoxGeometry(1,2,1,10,.5),new f.MeshStandardMaterial)).geometry.translate(0,-.5,0),d.capsuleInfo={radius:.5,segment:new f.Line3(new f.Vector3,new f.Vector3(0,-1,0))},d.castShadow=!0,d.receiveShadow=!0,d.material.shadowSide=2,a.add(d),I(),(r=new S.GUI).add(V,"firstPerson").onChange(e=>{e||t.position.sub(p.target).normalize().multiplyScalar(10).add(p.target)});let u=r.addFolder("Visualization");u.add(V,"displayCollider"),u.add(V,"displayBVH"),u.add(V,"visualizeDepth",1,20,1).onChange(e=>{l.depth=e,l.update()}),u.open();let y=r.addFolder("Player");y.add(V,"physicsSteps",0,30,1),y.add(V,"gravity",-100,100,.01).onChange(e=>{V.gravity=parseFloat(e)}),y.add(V,"playerSpeed",1,20),y.open(),r.add(V,"reset"),r.open(),window.addEventListener("resize",function(){t.aspect=window.innerWidth/window.innerHeight,t.updateProjectionMatrix(),e.setSize(window.innerWidth,window.innerHeight)},!1),window.addEventListener("keydown",function(e){switch(e.code){case"KeyW":E=!0;break;case"KeyS":C=!0;break;case"KeyD":W=!0;break;case"KeyA":H=!0;break;case"Space":A&&(k.y=10,A=!1)}}),window.addEventListener("keyup",function(e){switch(e.code){case"KeyW":E=!1;break;case"KeyS":C=!1;break;case"KeyD":W=!1;break;case"KeyA":H=!1}})})(),function r(){s.update(),requestAnimationFrame(r);let n=Math.min(i.getDelta(),.1);if(V.firstPerson?(p.maxPolarAngle=Math.PI,p.minDistance=1e-4,p.maxDistance=1e-4):(p.maxPolarAngle=Math.PI/2,p.minDistance=1,p.maxDistance=20),o){o.visible=V.displayCollider,l.visible=V.displayBVH;let e=V.physicsSteps;for(let a=0;a<e;a++)!function(e){A?k.y=e*V.gravity:k.y+=e*V.gravity,d.position.addScaledVector(k,e);let a=p.getAzimuthalAngle();E&&(R.set(0,0,-1).applyAxisAngle(D,a),d.position.addScaledVector(R,V.playerSpeed*e)),C&&(R.set(0,0,1).applyAxisAngle(D,a),d.position.addScaledVector(R,V.playerSpeed*e)),H&&(R.set(-1,0,0).applyAxisAngle(D,a),d.position.addScaledVector(R,V.playerSpeed*e)),W&&(R.set(1,0,0).applyAxisAngle(D,a),d.position.addScaledVector(R,V.playerSpeed*e)),d.updateMatrixWorld();let i=d.capsuleInfo;G.makeEmpty(),L.copy(o.matrixWorld).invert(),T.copy(i.segment),T.start.applyMatrix4(d.matrixWorld).applyMatrix4(L),T.end.applyMatrix4(d.matrixWorld).applyMatrix4(L),G.expandByPoint(T.start),G.expandByPoint(T.end),G.min.addScalar(-i.radius),G.max.addScalar(i.radius),o.geometry.boundsTree.shapecast({intersectsBounds:e=>e.intersectsBox(G),intersectsTriangle:e=>{let t=e.closestPointToSegment(T,R,_);if(t<i.radius){let e=i.radius-t,a=_.sub(R).normalize();T.start.addScaledVector(a,e),T.end.addScaledVector(a,e)}}}),R.copy(T.start).applyMatrix4(o.matrixWorld),_.subVectors(R,d.position),A=_.y>Math.abs(e*k.y*.25);let r=Math.max(0,_.length()-1e-5);_.normalize().multiplyScalar(r),d.position.add(_),A?k.set(0,0,0):(_.normalize(),k.addScaledVector(_,-_.dot(k))),t.position.sub(p.target),p.target.copy(d.position),t.position.add(d.position),d.position.y<-25&&I()}(n/e)}p.update(),e.render(a,t)}();
//# sourceMappingURL=characterMovement.65b34017.js.map
