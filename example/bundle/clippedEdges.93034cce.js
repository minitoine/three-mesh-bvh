let e,t,i,r,a,n,l,s,o,d,p,c,h,u,m;var f=globalThis,y={},w={},g=f.parcelRequire4485;null==g&&((g=function(e){if(e in y)return y[e].exports;if(e in w){var t=w[e];delete w[e];var i={id:e,exports:{}};return y[e]=i,t.call(i.exports,i,i.exports),i.exports}var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){w[e]=t},f.parcelRequire4485=g);var M=g.register;M("c8CJQ",function(e,t){var i;e.exports,e.exports=((i=function(){function e(e){return a.appendChild(e.dom),e}function t(e){for(var t=0;t<a.children.length;t++)a.children[t].style.display=t===e?"block":"none";r=e}var r=0,a=document.createElement("div");a.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",a.addEventListener("click",function(e){e.preventDefault(),t(++r%a.children.length)},!1);var n=(performance||Date).now(),l=n,s=0,o=e(new i.Panel("FPS","#0ff","#002")),d=e(new i.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var p=e(new i.Panel("MB","#f08","#201"));return t(0),{REVISION:16,dom:a,addPanel:e,showPanel:t,begin:function(){n=(performance||Date).now()},end:function(){s++;var e=(performance||Date).now();if(d.update(e-n,200),e>l+1e3&&(o.update(1e3*s/(e-l),100),l=e,s=0,p)){var t=performance.memory;p.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){n=this.end()},domElement:a,setMode:t}}).Panel=function(e,t,i){var r=1/0,a=0,n=Math.round,l=n(window.devicePixelRatio||1),s=80*l,o=48*l,d=3*l,p=2*l,c=3*l,h=15*l,u=74*l,m=30*l,f=document.createElement("canvas");f.width=s,f.height=o,f.style.cssText="width:80px;height:48px";var y=f.getContext("2d");return y.font="bold "+9*l+"px Helvetica,Arial,sans-serif",y.textBaseline="top",y.fillStyle=i,y.fillRect(0,0,s,o),y.fillStyle=t,y.fillText(e,d,p),y.fillRect(c,h,u,m),y.fillStyle=i,y.globalAlpha=.9,y.fillRect(c,h,u,m),{dom:f,update:function(o,w){r=Math.min(r,o),a=Math.max(a,o),y.fillStyle=i,y.globalAlpha=1,y.fillRect(0,0,s,h),y.fillStyle=t,y.fillText(n(o)+" "+e+" ("+n(r)+"-"+n(a)+")",d,p),y.drawImage(f,c+l,h,u-l,m,c,h,u-l,m),y.fillRect(c+u-l,h,l,m),y.fillStyle=i,y.globalAlpha=.9,y.fillRect(c+u-l,h,l,n((1-o/w)*m))}}},i)}),M("5ca9G",function(e,t){Object.defineProperty(e.exports,"MeshBVHHelper",{get:()=>s,set:void 0,enumerable:!0,configurable:!0});var i=g("ilwiq"),r=g("aw71y"),a=g("ff8ed");let n=new i.Box3;class l extends i.Object3D{get isMesh(){return!this.displayEdges}get isLineSegments(){return this.displayEdges}get isLine(){return this.displayEdges}constructor(e,t,r=10,a=0){super(),this.material=t,this.geometry=new i.BufferGeometry,this.name="MeshBVHRootHelper",this.depth=r,this.displayParents=!1,this.bvh=e,this.displayEdges=!0,this._group=a}raycast(){}update(){let e=this.geometry,t=this.bvh,a=this._group;if(e.dispose(),this.visible=!1,t){let l,s;let o=this.depth-1,d=this.displayParents,p=0;t.traverse((e,t)=>{if(e>=o||t)return p++,!0;d&&p++},a);let c=0,h=new Float32Array(24*p);t.traverse((e,t,i)=>{let a=e>=o||t;if(a||d){(0,r.arrayToBox)(0,i,n);let{min:e,max:t}=n;for(let i=-1;i<=1;i+=2){let r=i<0?e.x:t.x;for(let i=-1;i<=1;i+=2){let a=i<0?e.y:t.y;for(let i=-1;i<=1;i+=2){let n=i<0?e.z:t.z;h[c+0]=r,h[c+1]=a,h[c+2]=n,c+=3}}}return a}},a),s=new Uint8Array(this.displayEdges?[0,4,1,5,2,6,3,7,0,2,1,3,4,6,5,7,0,1,2,3,4,5,6,7]:[0,1,2,2,1,3,4,6,5,6,7,5,1,4,5,0,4,1,2,3,6,3,7,6,0,2,4,2,6,4,1,5,3,3,5,7]),l=h.length>65535?new Uint32Array(s.length*p):new Uint16Array(s.length*p);let u=s.length;for(let e=0;e<p;e++){let t=8*e,i=e*u;for(let e=0;e<u;e++)l[i+e]=t+s[e]}e.setIndex(new i.BufferAttribute(l,1,!1)),e.setAttribute("position",new i.BufferAttribute(h,3,!1)),this.visible=!0}}}class s extends i.Group{get color(){return this.edgeMaterial.color}get opacity(){return this.edgeMaterial.opacity}set opacity(e){this.edgeMaterial.opacity=e,this.meshMaterial.opacity=e}constructor(e=null,t=null,r=10){e instanceof a.MeshBVH&&(r=t||10,t=e,e=null),"number"==typeof t&&(r=t,t=null),super(),this.name="MeshBVHHelper",this.depth=r,this.mesh=e,this.bvh=t,this.displayParents=!1,this.displayEdges=!0,this._roots=[];let n=new i.LineBasicMaterial({color:65416,transparent:!0,opacity:.3,depthWrite:!1}),l=new i.MeshBasicMaterial({color:65416,transparent:!0,opacity:.3,depthWrite:!1});l.color=n.color,this.edgeMaterial=n,this.meshMaterial=l,this.update()}update(){let e=this.bvh||this.mesh.geometry.boundsTree,t=e?e._roots.length:0;for(;this._roots.length>t;){let e=this._roots.pop();e.geometry.dispose(),this.remove(e)}for(let i=0;i<t;i++){let{depth:t,edgeMaterial:r,meshMaterial:a,displayParents:n,displayEdges:s}=this;if(i>=this._roots.length){let a=new l(e,r,t,i);this.add(a),this._roots.push(a)}let o=this._roots[i];o.bvh=e,o.depth=t,o.displayParents=n,o.displayEdges=s,o.material=s?r:a,o.update()}}updateMatrixWorld(...e){let t=this.mesh,i=this.parent;null!==t&&(t.updateWorldMatrix(!0,!1),i?this.matrix.copy(i.matrixWorld).invert().multiply(t.matrixWorld):this.matrix.copy(t.matrixWorld),this.matrix.decompose(this.position,this.quaternion,this.scale)),super.updateMatrixWorld(...e)}copy(e){this.depth=e.depth,this.mesh=e.mesh,this.bvh=e.bvh,this.opacity=e.opacity,this.color.copy(e.color)}clone(){return new s(this.mesh,this.bvh,this.depth)}dispose(){this.edgeMaterial.dispose(),this.meshMaterial.dispose();let e=this.children;for(let t=0,i=e.length;t<i;t++)e[t].geometry.dispose()}}});var x=g("ilwiq"),v=g("7lx9d"),b=g("kp7Te"),S=g("5Rd1x"),B=g("c8CJQ"),P=g("jiuw3"),W=g("Mleu6"),D=g("ff8ed"),E=g("5ca9G");const L={useBVH:!0,helperDisplay:!1,helperDepth:10,wireframeDisplay:!1,displayModel:!0,animate:!0,animation:"SPIN",invert:!1};let O=!1,F=null,R=0;const C=new x.Vector3,H=new x.Vector3,A=new x.Vector3,T=new x.Vector3,I=new x.Line3,_=new x.Matrix4,G=new x.Plane;(function(){F=document.getElementById("output");let f=new x.Color(2503224).multiplyScalar(.1);(e=new x.WebGLRenderer({antialias:!0})).setPixelRatio(window.devicePixelRatio),e.setSize(window.innerWidth,window.innerHeight),e.setClearColor(f,1),e.shadowMap.enabled=!0,e.shadowMap.type=x.PCFSoftShadowMap,e.outputEncoding=x.sRGBEncoding,e.localClippingEnabled=!0,document.body.appendChild(e.domElement),(i=new x.Scene).fog=new x.Fog(f,20,70);let y=new x.DirectionalLight(16777215,.8);y.position.set(1,1.5,2).multiplyScalar(50),i.add(y),i.add(new x.HemisphereLight(16777215,2241348,.5)),(t=new x.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.01,50)).position.set(.4,.4,.4),t.far=100,t.updateProjectionMatrix(),n=new S.OrbitControls(t,e.domElement),l=new x.Clock,u=[new x.Plane],(h=new x.Mesh(new x.PlaneBufferGeometry,new x.MeshBasicMaterial({side:x.DoubleSide,stencilWrite:!0,stencilFunc:x.NotEqualStencilFunc,stencilFail:x.ZeroStencilOp,stencilZFail:x.ZeroStencilOp,stencilZPass:x.ZeroStencilOp}))).scale.setScalar(1.5),h.material.color.set(8445674).convertLinearToSRGB(),h.renderOrder=2,i.add(h);let w=new x.BufferGeometry,g=new x.BufferAttribute(new Float32Array(3e5),3,!1);g.setUsage(x.DynamicDrawUsage),w.setAttribute("position",g),(m=new x.LineSegments(w,new x.LineBasicMaterial)).material.color.set(44225).convertSRGBToLinear(),m.frustumCulled=!1,m.renderOrder=3;let M=new v.GLTFLoader;M.setMeshoptDecoder(b.MeshoptDecoder),M.load("../models/internal_combustion_engine/model.gltf",e=>{let t=e.scene.children[0],r=t.geometry;t.material=new x.MeshBasicMaterial,t.position.set(0,0,0),t.quaternion.identity();let a=t.clone();a.material=new x.MeshStandardMaterial({depthFunc:x.EqualDepth}),a.renderOrder=1,m.scale.copy(t.scale),m.position.set(0,0,0),m.quaternion.identity(),t.updateMatrixWorld(!0);let n=new Set,l=new Map;(p=t).updateMatrixWorld(!0),p.traverse(e=>{if(e.isMesh){if(l.has(e.material)){e.material=l.get(e.material);return}n.add(e.material);let t=e.material.clone();t.color.set(16777215),t.roughness=1,t.metalness=0,t.side=x.FrontSide,t.stencilWrite=!0,t.stencilFail=x.IncrementWrapStencilOp,t.stencilZFail=x.IncrementWrapStencilOp,t.stencilZPass=x.IncrementWrapStencilOp,t.clippingPlanes=u,l.set(e.material,t),e.material=t}}),l.clear(),(c=p.clone()).traverse(e=>{if(e.isMesh){if(l.has(e.material)){e.material=l.get(e.material);return}let t=e.material.clone();t.color.set(16777215),t.roughness=1,t.metalness=0,t.colorWrite=!1,t.depthWrite=!1,t.side=x.BackSide,t.stencilWrite=!0,t.stencilFail=x.DecrementWrapStencilOp,t.stencilZFail=x.DecrementWrapStencilOp,t.stencilZPass=x.DecrementWrapStencilOp,t.clippingPlanes=u,l.set(e.material,t),e.material=t}}),s=new D.MeshBVH(r,{maxLeafTris:3}),r.boundsTree=s,(o=new x.Mesh(r,new x.MeshBasicMaterial({wireframe:!0,transparent:!0,opacity:.01,depthWrite:!1}))).renderOrder=2,o.position.copy(t.position),o.rotation.copy(t.rotation),o.scale.copy(t.scale),(d=new E.MeshBVHHelper(o,parseInt(L.helperDepth))).depth=parseInt(L.helperDepth),d.update();let h=new x.Group;h.add(p,c,a,o,d,m);let f=new x.Box3;f.setFromObject(p),f.getCenter(h.position).multiplyScalar(-1),h.updateMatrixWorld(!0),i.add(h)}),(r=new P.GUI).add(L,"invert"),r.add(L,"animate"),r.add(L,"animation",["SPIN","OSCILLATE"]).onChange(()=>{R=0}),r.add(L,"displayModel"),r.add(L,"useBVH");let W=r.addFolder("helper");W.add(L,"wireframeDisplay"),W.add(L,"helperDisplay"),W.add(L,"helperDepth",1,20,1).onChange(e=>{d&&(d.depth=parseInt(e),d.update())}),W.open(),r.open(),a=new(B&&B.__esModule?B.default:B),document.body.appendChild(a.domElement),window.addEventListener("resize",function(){t.aspect=window.innerWidth/window.innerHeight,t.updateProjectionMatrix(),e.setSize(window.innerWidth,window.innerHeight),e.setPixelRatio(window.devicePixelRatio)},!1)})(),function r(){d&&(d.visible=L.helperDisplay,o.visible=L.wireframeDisplay,p.visible=L.displayModel,c.visible=L.displayModel),m.material.color.set(L.displayModel?44225:5099745).convertSRGBToLinear();let f=Math.min(l.getDelta(),.03);L.animate&&(R+=f,"SPIN"===L.animation?(h.rotation.x=.25*R,h.rotation.y=.25*R,h.rotation.z=.25*R,h.position.set(0,0,0)):(h.position.set(.325*Math.sin(.25*R),0,0),h.rotation.set(0,Math.PI/2,0)),h.updateMatrixWorld());let y=u[0];if(y.normal.set(0,0,L.invert?1:-1),y.constant=0,y.applyMatrix4(h.matrixWorld),s&&(L.animate||!O)){O=!0,_.copy(o.matrixWorld).invert(),G.copy(y).applyMatrix4(_);let e=0,t=m.geometry.attributes.position,i=window.performance.now();s.shapecast({intersectsBounds:e=>L.useBVH?G.intersectsBox(e):W.CONTAINED,intersectsTriangle:i=>{let r=0;I.start.copy(i.a),I.end.copy(i.b),G.intersectLine(I,C)&&(t.setXYZ(e,C.x,C.y,C.z),e++,r++),I.start.copy(i.b),I.end.copy(i.c),G.intersectLine(I,C)&&(t.setXYZ(e,C.x,C.y,C.z),r++,e++),I.start.copy(i.c),I.end.copy(i.a),G.intersectLine(I,C)&&(t.setXYZ(e,C.x,C.y,C.z),r++,e++),3===r&&(H.fromBufferAttribute(t,e-3),A.fromBufferAttribute(t,e-2),T.fromBufferAttribute(t,e-1),T.equals(H)||T.equals(A)?(r--,e--):H.equals(A)&&(t.setXYZ(e-2,T),r--,e--)),2!==r&&(e-=r)}}),m.geometry.setDrawRange(0,e),m.position.copy(y.normal).multiplyScalar(-.00001),t.needsUpdate=!0;let r=window.performance.now()-i;F.innerText=`${parseFloat(r.toFixed(3))}ms`}a.update(),requestAnimationFrame(r),n.update(),e.render(i,t)}();
//# sourceMappingURL=clippedEdges.93034cce.js.map
