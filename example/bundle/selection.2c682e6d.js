let e,t,r,i,n,o,l,a,s,d,p,h,c;var u=globalThis,f={},y={},m=u.parcelRequire4485;null==m&&((m=function(e){if(e in f)return f[e].exports;if(e in y){var t=y[e];delete y[e];var r={id:e,exports:{}};return f[e]=r,t.call(r.exports,r,r.exports),r.exports}var i=Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){y[e]=t},u.parcelRequire4485=m);var g=m.register;g("c8CJQ",function(e,t){var r;e.exports,e.exports=((r=function(){function e(e){return n.appendChild(e.dom),e}function t(e){for(var t=0;t<n.children.length;t++)n.children[t].style.display=t===e?"block":"none";i=e}var i=0,n=document.createElement("div");n.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",n.addEventListener("click",function(e){e.preventDefault(),t(++i%n.children.length)},!1);var o=(performance||Date).now(),l=o,a=0,s=e(new r.Panel("FPS","#0ff","#002")),d=e(new r.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var p=e(new r.Panel("MB","#f08","#201"));return t(0),{REVISION:16,dom:n,addPanel:e,showPanel:t,begin:function(){o=(performance||Date).now()},end:function(){a++;var e=(performance||Date).now();if(d.update(e-o,200),e>l+1e3&&(s.update(1e3*a/(e-l),100),l=e,a=0,p)){var t=performance.memory;p.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){o=this.end()},domElement:n,setMode:t}}).Panel=function(e,t,r){var i=1/0,n=0,o=Math.round,l=o(window.devicePixelRatio||1),a=80*l,s=48*l,d=3*l,p=2*l,h=3*l,c=15*l,u=74*l,f=30*l,y=document.createElement("canvas");y.width=a,y.height=s,y.style.cssText="width:80px;height:48px";var m=y.getContext("2d");return m.font="bold "+9*l+"px Helvetica,Arial,sans-serif",m.textBaseline="top",m.fillStyle=r,m.fillRect(0,0,a,s),m.fillStyle=t,m.fillText(e,d,p),m.fillRect(h,c,u,f),m.fillStyle=r,m.globalAlpha=.9,m.fillRect(h,c,u,f),{dom:y,update:function(s,g){i=Math.min(i,s),n=Math.max(n,s),m.fillStyle=r,m.globalAlpha=1,m.fillRect(0,0,a,c),m.fillStyle=t,m.fillText(o(s)+" "+e+" ("+o(i)+"-"+o(n)+")",d,p),m.drawImage(y,h+l,c,u-l,f,h,c,u-l,f),m.fillRect(h+u-l,c,l,f),m.fillStyle=r,m.globalAlpha=.9,m.fillRect(h+u-l,c,l,o((1-s/g)*f))}}},r)}),g("5ca9G",function(e,t){Object.defineProperty(e.exports,"MeshBVHHelper",{get:()=>a,set:void 0,enumerable:!0,configurable:!0});var r=m("ilwiq"),i=m("aw71y"),n=m("ff8ed");let o=new r.Box3;class l extends r.Object3D{get isMesh(){return!this.displayEdges}get isLineSegments(){return this.displayEdges}get isLine(){return this.displayEdges}constructor(e,t,i=10,n=0){super(),this.material=t,this.geometry=new r.BufferGeometry,this.name="MeshBVHRootHelper",this.depth=i,this.displayParents=!1,this.bvh=e,this.displayEdges=!0,this._group=n}raycast(){}update(){let e=this.geometry,t=this.bvh,n=this._group;if(e.dispose(),this.visible=!1,t){let l,a;let s=this.depth-1,d=this.displayParents,p=0;t.traverse((e,t)=>{if(e>=s||t)return p++,!0;d&&p++},n);let h=0,c=new Float32Array(24*p);t.traverse((e,t,r)=>{let n=e>=s||t;if(n||d){(0,i.arrayToBox)(0,r,o);let{min:e,max:t}=o;for(let r=-1;r<=1;r+=2){let i=r<0?e.x:t.x;for(let r=-1;r<=1;r+=2){let n=r<0?e.y:t.y;for(let r=-1;r<=1;r+=2){let o=r<0?e.z:t.z;c[h+0]=i,c[h+1]=n,c[h+2]=o,h+=3}}}return n}},n),a=new Uint8Array(this.displayEdges?[0,4,1,5,2,6,3,7,0,2,1,3,4,6,5,7,0,1,2,3,4,5,6,7]:[0,1,2,2,1,3,4,6,5,6,7,5,1,4,5,0,4,1,2,3,6,3,7,6,0,2,4,2,6,4,1,5,3,3,5,7]),l=c.length>65535?new Uint32Array(a.length*p):new Uint16Array(a.length*p);let u=a.length;for(let e=0;e<p;e++){let t=8*e,r=e*u;for(let e=0;e<u;e++)l[r+e]=t+a[e]}e.setIndex(new r.BufferAttribute(l,1,!1)),e.setAttribute("position",new r.BufferAttribute(c,3,!1)),this.visible=!0}}}class a extends r.Group{get color(){return this.edgeMaterial.color}get opacity(){return this.edgeMaterial.opacity}set opacity(e){this.edgeMaterial.opacity=e,this.meshMaterial.opacity=e}constructor(e=null,t=null,i=10){e instanceof n.MeshBVH&&(i=t||10,t=e,e=null),"number"==typeof t&&(i=t,t=null),super(),this.name="MeshBVHHelper",this.depth=i,this.mesh=e,this.bvh=t,this.displayParents=!1,this.displayEdges=!0,this._roots=[];let o=new r.LineBasicMaterial({color:65416,transparent:!0,opacity:.3,depthWrite:!1}),l=new r.MeshBasicMaterial({color:65416,transparent:!0,opacity:.3,depthWrite:!1});l.color=o.color,this.edgeMaterial=o,this.meshMaterial=l,this.update()}update(){let e=this.bvh||this.mesh.geometry.boundsTree,t=e?e._roots.length:0;for(;this._roots.length>t;){let e=this._roots.pop();e.geometry.dispose(),this.remove(e)}for(let r=0;r<t;r++){let{depth:t,edgeMaterial:i,meshMaterial:n,displayParents:o,displayEdges:a}=this;if(r>=this._roots.length){let n=new l(e,i,t,r);this.add(n),this._roots.push(n)}let s=this._roots[r];s.bvh=e,s.depth=t,s.displayParents=o,s.displayEdges=a,s.material=a?i:n,s.update()}}updateMatrixWorld(...e){let t=this.mesh,r=this.parent;null!==t&&(t.updateWorldMatrix(!0,!1),r?this.matrix.copy(r.matrixWorld).invert().multiply(t.matrixWorld):this.matrix.copy(t.matrixWorld),this.matrix.decompose(this.position,this.quaternion,this.scale)),super.updateMatrixWorld(...e)}copy(e){this.depth=e.depth,this.mesh=e.mesh,this.bvh=e.bvh,this.opacity=e.opacity,this.color.copy(e.color)}clone(){return new a(this.mesh,this.bvh,this.depth)}dispose(){this.edgeMaterial.dispose(),this.meshMaterial.dispose();let e=this.children;for(let t=0,r=e.length;t<r;t++)e[t].geometry.dispose()}}});var w=m("ilwiq"),x=m("c8CJQ"),M=m("jiuw3"),v=m("5Rd1x"),b=m("Mleu6"),E=m("ff8ed"),T=m("5ca9G");const S={toolMode:"lasso",selectionMode:"intersection",liveUpdate:!1,selectModel:!1,wireframe:!1,useBoundsTree:!0,displayHelper:!1,helperDepth:10,rotate:!0},B=[];let R=!1,A=!1,H=!1;(function(){h=document.getElementById("output");let u=new w.Color(2503224);(e=new w.WebGLRenderer({antialias:!0})).setPixelRatio(window.devicePixelRatio),e.setSize(window.innerWidth,window.innerHeight),e.setClearColor(u,1),e.shadowMap.enabled=!0,e.outputEncoding=w.sRGBEncoding,document.body.appendChild(e.domElement),r=new w.Scene;let f=new w.DirectionalLight(16777215,1);f.castShadow=!0,f.shadow.mapSize.set(2048,2048),f.position.set(10,10,10),r.add(f),r.add(new w.AmbientLight(11583173,.8)),(t=new w.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,50)).position.set(2,4,6),t.far=100,t.updateProjectionMatrix(),r.add(t),(l=new w.Line).material.color.set(16750592).convertSRGBToLinear(),l.renderOrder=1,l.position.z=-.2,l.depthTest=!1,l.scale.setScalar(1),t.add(l),c=new w.Group,r.add(c),(a=new w.Mesh(new w.TorusKnotGeometry(1.5,.5,500,60).toNonIndexed(),new w.MeshStandardMaterial({polygonOffset:!0,polygonOffsetFactor:1}))).geometry.boundsTree=new E.MeshBVH(a.geometry),a.geometry.setAttribute("color",new w.Uint8BufferAttribute(Array(3*a.geometry.index.count).fill(255),3,!0)),a.castShadow=!0,a.receiveShadow=!0,c.add(a),s=new T.MeshBVHHelper(a,10),c.add(s),(d=new w.Mesh).geometry=a.geometry.clone(),d.geometry.drawRange.count=0,d.material=new w.MeshBasicMaterial({opacity:.05,transparent:!0,depthWrite:!1}),d.material.color.set(16750592).convertSRGBToLinear(),d.renderOrder=1,c.add(d),(p=new w.Mesh).geometry=d.geometry,p.material=new w.MeshBasicMaterial({opacity:.25,transparent:!0,wireframe:!0,depthWrite:!1}),p.material.color.copy(d.material.color),p.renderOrder=2,c.add(p);let y=new w.GridHelper(10,10,16777215,16777215);y.material.opacity=.2,y.material.transparent=!0,y.position.y=-2.75,r.add(y);let m=new w.Mesh(new w.PlaneBufferGeometry,new w.ShadowMaterial({color:0,opacity:.2,depthWrite:!1}));m.position.y=-2.74,m.rotation.x=-Math.PI/2,m.scale.setScalar(20),m.renderOrder=2,m.receiveShadow=!0,r.add(m),n=new(x&&x.__esModule?x.default:x),document.body.appendChild(n.dom),(o=new v.OrbitControls(t,e.domElement)).minDistance=3,o.touches.ONE=w.TOUCH.PAN,o.mouseButtons.LEFT=w.MOUSE.PAN,o.touches.TWO=w.TOUCH.ROTATE,o.mouseButtons.RIGHT=w.MOUSE.ROTATE,o.enablePan=!1;let g=(i=new M.GUI).addFolder("selection");g.add(S,"toolMode",["lasso","box"]),g.add(S,"selectionMode",["centroid","centroid-visible","intersection"]),g.add(S,"selectModel"),g.add(S,"liveUpdate"),g.add(S,"useBoundsTree"),g.open();let b=i.addFolder("display");b.add(S,"wireframe"),b.add(S,"rotate"),b.add(S,"displayHelper"),b.add(S,"helperDepth",1,30,1).onChange(e=>{s.depth=e,s.update()}),b.open(),i.open();let O=-1/0,P=-1/0,C=-1/0,W=-1/0,D=new w.Vector2,L=new w.Vector2,U=new w.Vector2;e.domElement.addEventListener("pointerdown",e=>{C=e.clientX,W=e.clientY,O=e.clientX/window.innerWidth*2-1,P=-(e.clientY/window.innerHeight*2-1),B.length=0,R=!0}),e.domElement.addEventListener("pointerup",()=>{l.visible=!1,R=!1,B.length&&(H=!0)}),e.domElement.addEventListener("pointermove",e=>{if((1&e.buttons)==0)return;let t=e.clientX,r=e.clientY,i=e.clientX/window.innerWidth*2-1,n=-(e.clientY/window.innerHeight*2-1);if("box"===S.toolMode)B.length=15,B[0]=O,B[1]=P,B[2]=0,B[3]=i,B[4]=P,B[5]=0,B[6]=i,B[7]=n,B[8]=0,B[9]=O,B[10]=n,B[11]=0,B[12]=O,B[13]=P,B[14]=0,(t!==C||r!==W)&&(A=!0),C=t,W=r,l.visible=!0,S.liveUpdate&&(H=!0);else if(Math.abs(t-C)>=3||Math.abs(r-W)>=3){let e=3*(B.length/3-1),o=!1;B.length>3&&(D.set(B[e-3],B[e-3+1]),L.set(B[e],B[e+1]),L.sub(D).normalize(),D.set(B[e],B[e+1]),U.set(i,n),U.sub(D).normalize(),o=L.dot(U)>.99),o?(B[e]=i,B[e+1]=n):B.push(i,n,0),A=!0,l.visible=!0,C=t,W=r,S.liveUpdate&&(H=!0)}}),window.addEventListener("resize",function(){t.aspect=window.innerWidth/window.innerHeight,t.updateProjectionMatrix(),e.setSize(window.innerWidth,window.innerHeight)},!1)})(),function i(){if(n.update(),requestAnimationFrame(i),a.material.wireframe=S.wireframe,s.visible=S.displayHelper,A){if("lasso"===S.toolMode){let e=B.length;B.push(B[0],B[1],B[2]),l.geometry.setAttribute("position",new w.Float32BufferAttribute(B,3,!1)),B.length=e}else l.geometry.setAttribute("position",new w.Float32BufferAttribute(B,3,!1));l.frustumCulled=!1,A=!1}H&&(H=!1,B.length>0&&function(){for(U.copy(a.matrixWorld).premultiply(t.matrixWorldInverse).premultiply(t.projectionMatrix);V.length<B.length;)V.push(new w.Line3);V.length=B.length;for(let e=0,t=B.length;e<t;e+=3){let r=V[e],i=(e+3)%t;r.start.x=B[e],r.start.y=B[e+1],r.end.x=B[i],r.end.y=B[i+1]}O.copy(a.matrixWorld).invert(),P.set(0,0,0).applyMatrix4(t.matrixWorld).applyMatrix4(O);let e=window.performance.now(),r=[];a.geometry.boundsTree.shapecast({intersectsBounds:(e,t,r,i)=>{if(!S.useBoundsTree)return b.INTERSECTED;let{min:n,max:o}=e,l=0,a=1/0,s=-1/0,d=1/0;for(let e=0;e<=1;e++)for(let t=0;t<=1;t++)for(let r=0;r<=1;r++){let i=N[l];i.x=0===e?n.x:o.x,i.y=0===t?n.y:o.y,i.z=0===r?n.z:o.z,i.w=1,i.applyMatrix4(U),l++,i.y<a&&(a=i.y),i.y>s&&(s=i.y),i.x<d&&(d=i.x)}let p=z[i-1]||V,h=z[i]||[];h.length=0,z[i]=h;for(let e=0,t=p.length;e<t;e++){let t=p[e],r=t.start.x,i=t.start.y,n=t.end.x,o=t.end.y;if(r<d&&n<d)continue;let l=i>s,c=o>s;if(l&&c)continue;let u=i<a,f=o<a;u&&f||h.push(t)}if(0===h.length)return b.NOT_INTERSECTED;let c=function(e){function t(e,t,r){let i=(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y);return 0==i?0:i>0?1:2}function r(e,t){return(e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)}let i=1/0,n=-1;for(let t=0,r=e.length;t<r;t++){let r=e[t];r.y<i&&(n=t,i=r.y)}let o=e[n];e[n]=e[0],e[0]=o;let l=1,a=(e=e.sort(function(e,i){let n=t(o,e,i);return 0==n?r(o,i)>=r(o,e)?-1:1:2==n?-1:1})).length;for(let r=1;r<a;r++){for(;r<a-1&&0==t(o,e[r],e[r+1]);)r++;e[l]=e[r],l++}if(l<3)return null;let s=[e[0],e[1],e[2]];for(let r=3;r<l;r++){for(;2!==t(s[s.length-2],s[s.length-1],e[r]);)s.pop();s.push(e[r])}return s}(N),u=c.map((e,t)=>{let r=c[(t+1)%c.length],i=I[t];return i.start.copy(e),i.end.copy(r),i});if(G(h[0].start,u)%2==1)return b.INTERSECTED;let f=0;for(let e=0,t=c.length;e<t;e++){let t=G(c[e],h);if(0===e&&(f=t),f!==t)return b.INTERSECTED}for(let e=0,t=u.length;e<t;e++){let t=u[e];for(let e=0,r=h.length;e<r;e++)if(_(t,h[e]))return b.INTERSECTED}return f%2==0?b.NOT_INTERSECTED:b.CONTAINED},intersectsTriangle:(e,t,i,n)=>{let o=3*t,l=o+0,s=o+1,d=o+2,p=S.useBoundsTree?z[n]:V;if("centroid"===S.selectionMode||"centroid-visible"===S.selectionMode){if(W.copy(e.a).add(e.b).add(e.c).multiplyScalar(1/3),D.copy(W).applyMatrix4(U),i||G(D,p)%2==1)return!("centroid-visible"===S.selectionMode&&(e.getNormal(L),C.origin.copy(W).addScaledVector(L,1e-6),C.direction.subVectors(P,W),a.geometry.boundsTree.raycastFirst(C,w.DoubleSide)))&&(r.push(l,s,d),S.selectModel)}else if("intersection"===S.selectionMode){if(i)return r.push(l,s,d),S.selectModel;let t=[e.a,e.b,e.c];for(let e=0;e<3;e++){let i=t[e];if(i.applyMatrix4(U),G(i,p)%2==1)return r.push(l,s,d),S.selectModel}let n=[I[0],I[1],I[2]];n[0].start.copy(e.a),n[0].end.copy(e.b),n[1].start.copy(e.b),n[1].end.copy(e.c),n[2].start.copy(e.c),n[2].end.copy(e.a);for(let e=0;e<3;e++){let t=n[e];for(let e=0,i=p.length;e<i;e++)if(_(t,p[e]))return r.push(l,s,d),S.selectModel}}return!1}});let i=window.performance.now()-e;h.innerText=`${i.toFixed(3)}ms`;let n=a.geometry.index,o=d.geometry.index;if(r.length&&S.selectModel){for(let e=0,t=n.count;e<t;e++){let t=n.getX(e);o.setX(e,t)}d.geometry.drawRange.count=1/0,o.needsUpdate=!0}else{for(let e=0,t=r.length;e<t;e++){let t=n.getX(r[e]);o.setX(e,t)}d.geometry.drawRange.count=r.length,o.needsUpdate=!0}}());let o=Math.tan(w.MathUtils.DEG2RAD*t.fov/2)*l.position.z;l.scale.set(-o*t.aspect,-o,1),e.render(r,t),S.rotate&&(c.rotation.y+=.01,S.liveUpdate&&R&&(H=!0))}();const O=new w.Matrix4,P=new w.Vector3,C=new w.Ray,W=new w.Vector3,D=new w.Vector3,L=new w.Vector3,U=new w.Matrix4,N=Array(8).fill().map(()=>new w.Vector3),I=Array(12).fill().map(()=>new w.Line3),V=[],z=[];function G(e,t){let r=0,i=t[t.length-1],n=i.start.y>i.end.y;for(let i=0,o=t.length;i<o;i++){let o=t[i],l=o.start.y>o.end.y;(function(e,t,r,i){let{start:n,end:o}=t,l=e.x,a=e.y,s=n.y,d=o.y;if(s===d||a>s&&a>d||a<s&&a<d)return!1;let p=n.x,h=o.x;if(l>p&&l>h)return!1;if(l<p&&l<h)return a!==s||r===i;let c=d-s;return Math.sign(c*(l-p)+-(h-p)*(a-s))!==Math.sign(c)})(e,o,n,l)&&r++,n=l}return r}function _(e,t){function r(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}let i=e.start,n=e.end,o=t.start,l=t.end;return r(i,o,l)!==r(n,o,l)&&r(i,n,o)!==r(i,n,l)}
//# sourceMappingURL=selection.2c682e6d.js.map
