let e,t,i,r,o,n,s,a;function l(e,t,i,r){Object.defineProperty(e,t,{get:i,set:r,enumerable:!0,configurable:!0})}var d=globalThis,p={},h={},c=d.parcelRequire4485;null==c&&((c=function(e){if(e in p)return p[e].exports;if(e in h){var t=h[e];delete h[e];var i={id:e,exports:{}};return p[e]=i,t.call(i.exports,i,i.exports),i.exports}var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){h[e]=t},d.parcelRequire4485=c);var u=c.register;u("c8CJQ",function(e,t){var i;e.exports,e.exports=((i=function(){function e(e){return o.appendChild(e.dom),e}function t(e){for(var t=0;t<o.children.length;t++)o.children[t].style.display=t===e?"block":"none";r=e}var r=0,o=document.createElement("div");o.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",o.addEventListener("click",function(e){e.preventDefault(),t(++r%o.children.length)},!1);var n=(performance||Date).now(),s=n,a=0,l=e(new i.Panel("FPS","#0ff","#002")),d=e(new i.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var p=e(new i.Panel("MB","#f08","#201"));return t(0),{REVISION:16,dom:o,addPanel:e,showPanel:t,begin:function(){n=(performance||Date).now()},end:function(){a++;var e=(performance||Date).now();if(d.update(e-n,200),e>s+1e3&&(l.update(1e3*a/(e-s),100),s=e,a=0,p)){var t=performance.memory;p.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){n=this.end()},domElement:o,setMode:t}}).Panel=function(e,t,i){var r=1/0,o=0,n=Math.round,s=n(window.devicePixelRatio||1),a=80*s,l=48*s,d=3*s,p=2*s,h=3*s,c=15*s,u=74*s,m=30*s,y=document.createElement("canvas");y.width=a,y.height=l,y.style.cssText="width:80px;height:48px";var f=y.getContext("2d");return f.font="bold "+9*s+"px Helvetica,Arial,sans-serif",f.textBaseline="top",f.fillStyle=i,f.fillRect(0,0,a,l),f.fillStyle=t,f.fillText(e,d,p),f.fillRect(h,c,u,m),f.fillStyle=i,f.globalAlpha=.9,f.fillRect(h,c,u,m),{dom:y,update:function(l,w){r=Math.min(r,l),o=Math.max(o,l),f.fillStyle=i,f.globalAlpha=1,f.fillRect(0,0,a,c),f.fillStyle=t,f.fillText(n(l)+" "+e+" ("+n(r)+"-"+n(o)+")",d,p),f.drawImage(y,h+s,c,u-s,m,h,c,u-s,m),f.fillRect(h+u-s,c,s,m),f.fillStyle=i,f.globalAlpha=.9,f.fillRect(h+u-s,c,s,n((1-l/w)*m))}}},i)}),u("4h5hN",function(e,t){l(e.exports,"acceleratedRaycast",()=>d),l(e.exports,"computeBoundsTree",()=>p),l(e.exports,"disposeBoundsTree",()=>h);var i=c("ilwiq"),r=c("b4YKL"),o=c("ff8ed");let n=new i.Ray,s=new i.Matrix4,a=i.Mesh.prototype.raycast;function d(e,t){if(this.geometry.boundsTree){if(void 0===this.material)return;s.copy(this.matrixWorld).invert(),n.copy(e.ray).applyMatrix4(s);let i=this.geometry.boundsTree;if(!0===e.firstHitOnly){let o=(0,r.convertRaycastIntersect)(i.raycastFirst(n,this.material),this,e);o&&t.push(o)}else{let o=i.raycast(n,this.material);for(let i=0,n=o.length;i<n;i++){let n=(0,r.convertRaycastIntersect)(o[i],this,e);n&&t.push(n)}}}else a.call(this,e,t)}function p(e){return this.boundsTree=new o.MeshBVH(this,e),this.boundsTree}function h(){this.boundsTree=null}}),u("b4YKL",function(e,t){l(e.exports,"convertRaycastIntersect",()=>i);function i(e,t,i){return null===e?null:(e.point.applyMatrix4(t.matrixWorld),e.distance=e.point.distanceTo(i.ray.origin),e.object=t,e.distance<i.near||e.distance>i.far)?null:e}}),u("5ca9G",function(e,t){l(e.exports,"MeshBVHHelper",()=>a);var i=c("ilwiq"),r=c("aw71y"),o=c("ff8ed");let n=new i.Box3;class s extends i.Object3D{get isMesh(){return!this.displayEdges}get isLineSegments(){return this.displayEdges}get isLine(){return this.displayEdges}constructor(e,t,r=10,o=0){super(),this.material=t,this.geometry=new i.BufferGeometry,this.name="MeshBVHRootHelper",this.depth=r,this.displayParents=!1,this.bvh=e,this.displayEdges=!0,this._group=o}raycast(){}update(){let e=this.geometry,t=this.bvh,o=this._group;if(e.dispose(),this.visible=!1,t){let s,a;let l=this.depth-1,d=this.displayParents,p=0;t.traverse((e,t)=>{if(e>=l||t)return p++,!0;d&&p++},o);let h=0,c=new Float32Array(24*p);t.traverse((e,t,i)=>{let o=e>=l||t;if(o||d){(0,r.arrayToBox)(0,i,n);let{min:e,max:t}=n;for(let i=-1;i<=1;i+=2){let r=i<0?e.x:t.x;for(let i=-1;i<=1;i+=2){let o=i<0?e.y:t.y;for(let i=-1;i<=1;i+=2){let n=i<0?e.z:t.z;c[h+0]=r,c[h+1]=o,c[h+2]=n,h+=3}}}return o}},o),a=new Uint8Array(this.displayEdges?[0,4,1,5,2,6,3,7,0,2,1,3,4,6,5,7,0,1,2,3,4,5,6,7]:[0,1,2,2,1,3,4,6,5,6,7,5,1,4,5,0,4,1,2,3,6,3,7,6,0,2,4,2,6,4,1,5,3,3,5,7]),s=c.length>65535?new Uint32Array(a.length*p):new Uint16Array(a.length*p);let u=a.length;for(let e=0;e<p;e++){let t=8*e,i=e*u;for(let e=0;e<u;e++)s[i+e]=t+a[e]}e.setIndex(new i.BufferAttribute(s,1,!1)),e.setAttribute("position",new i.BufferAttribute(c,3,!1)),this.visible=!0}}}class a extends i.Group{get color(){return this.edgeMaterial.color}get opacity(){return this.edgeMaterial.opacity}set opacity(e){this.edgeMaterial.opacity=e,this.meshMaterial.opacity=e}constructor(e=null,t=null,r=10){e instanceof o.MeshBVH&&(r=t||10,t=e,e=null),"number"==typeof t&&(r=t,t=null),super(),this.name="MeshBVHHelper",this.depth=r,this.mesh=e,this.bvh=t,this.displayParents=!1,this.displayEdges=!0,this._roots=[];let n=new i.LineBasicMaterial({color:65416,transparent:!0,opacity:.3,depthWrite:!1}),s=new i.MeshBasicMaterial({color:65416,transparent:!0,opacity:.3,depthWrite:!1});s.color=n.color,this.edgeMaterial=n,this.meshMaterial=s,this.update()}update(){let e=this.bvh||this.mesh.geometry.boundsTree,t=e?e._roots.length:0;for(;this._roots.length>t;){let e=this._roots.pop();e.geometry.dispose(),this.remove(e)}for(let i=0;i<t;i++){let{depth:t,edgeMaterial:r,meshMaterial:o,displayParents:n,displayEdges:a}=this;if(i>=this._roots.length){let o=new s(e,r,t,i);this.add(o),this._roots.push(o)}let l=this._roots[i];l.bvh=e,l.depth=t,l.displayParents=n,l.displayEdges=a,l.material=a?r:o,l.update()}}updateMatrixWorld(...e){let t=this.mesh,i=this.parent;null!==t&&(t.updateWorldMatrix(!0,!1),i?this.matrix.copy(i.matrixWorld).invert().multiply(t.matrixWorld):this.matrix.copy(t.matrixWorld),this.matrix.decompose(this.position,this.quaternion,this.scale)),super.updateMatrixWorld(...e)}copy(e){this.depth=e.depth,this.mesh=e.mesh,this.bvh=e.bvh,this.opacity=e.opacity,this.color.copy(e.color)}clone(){return new a(this.mesh,this.bvh,this.depth)}dispose(){this.edgeMaterial.dispose(),this.meshMaterial.dispose();let e=this.children;for(let t=0,i=e.length;t<i;t++)e[t].geometry.dispose()}}});var m=c("c8CJQ"),y=c("jiuw3"),f=c("ilwiq"),w=c("5Rd1x"),g=c("fUhpq"),x=c("4h5hN"),v=c("5ca9G");f.Mesh.prototype.raycast=x.acceleratedRaycast,f.BufferGeometry.prototype.computeBoundsTree=x.computeBoundsTree,f.BufferGeometry.prototype.disposeBoundsTree=x.disposeBoundsTree;const b={speed:1,visualizeBounds:!1,visualBoundsDepth:10,shape:"sphere",position:new f.Vector3,rotation:new f.Euler,scale:new f.Vector3(1,1,1)};let M={};function B(){n&&!b.visualizeBounds&&(t.remove(n),n=null),!n&&b.visualizeBounds&&(n=new v.MeshBVHHelper(a),t.add(n)),n&&(n.depth=b.visualBoundsDepth)}let E=window.performance.now();!function(){(r=new f.WebGLRenderer({antialias:!0})).setPixelRatio(window.devicePixelRatio),r.setSize(window.innerWidth,window.innerHeight),r.setClearColor(1251612,1),document.body.appendChild(r.domElement),(t=new f.Scene).fog=new f.Fog(1251612,20,60);let n=new f.DirectionalLight(16777215,.5);n.position.set(1,1,1),t.add(n),t.add(new f.AmbientLight(16777215,.4));let l=new f.TorusKnotGeometry(1,.4,400,100),d=new f.MeshPhongMaterial({color:16777215,side:f.DoubleSide});(a=new f.Mesh(l,d)).geometry.computeBoundsTree(),t.add(a),(i=new f.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,50)).position.set(3,3,3),i.far=100,i.updateProjectionMatrix(),s=new g.TransformControls(i,r.domElement),t.add(s),o=new w.OrbitControls(i,r.domElement),e=new(m&&m.__esModule?m.default:m),document.body.appendChild(e.dom);let p=new f.MeshStandardMaterial({metalness:.1,transparent:!0,opacity:.75,premultipliedAlpha:!0});M.sphere=new f.Mesh(new f.SphereGeometry(1,50,50),p),t.add(M.sphere),M.box=new f.Mesh(new f.BoxGeometry(1,1,1),p),t.add(M.box),M.geometry=new f.Mesh(new f.TorusKnotGeometry(.5,.2,200,50),p),M.geometry.geometry.computeBoundsTree(),t.add(M.geometry);let h=new y.GUI;h.add(b,"speed").min(0).max(10),h.add(b,"visualizeBounds").onChange(()=>B()),h.add(b,"visualBoundsDepth").min(1).max(40).step(1).onChange(()=>B()),h.add(b,"shape",["sphere","box","geometry"]),h.add(s,"mode",["translate","rotate"]);let c=h.addFolder("position");c.add(b.position,"x").min(-5).max(5).step(.001),c.add(b.position,"y").min(-5).max(5).step(.001),c.add(b.position,"z").min(-5).max(5).step(.001),c.open();let u=h.addFolder("rotation");u.add(b.rotation,"x").min(-Math.PI).max(Math.PI).step(.001),u.add(b.rotation,"y").min(-Math.PI).max(Math.PI).step(.001),u.add(b.rotation,"z").min(-Math.PI).max(Math.PI).step(.001),u.open(),h.open(),s.addEventListener("change",function(){b.position.copy(M[b.shape].position),b.rotation.copy(M[b.shape].rotation),b.scale.copy(M[b.shape].scale),h.controllersRecursive().forEach(e=>e.updateDisplay())}),s.addEventListener("mouseDown",function(){o.enabled=!1}),s.addEventListener("mouseUp",function(){o.enabled=!0}),o.addEventListener("start",function(){s.enabled=!1}),o.addEventListener("end",function(){s.enabled=!0}),window.addEventListener("resize",function(){i.aspect=window.innerWidth/window.innerHeight,i.updateProjectionMatrix(),r.setSize(window.innerWidth,window.innerHeight)},!1),window.addEventListener("keydown",function(e){switch(e.key){case"w":s.mode="translate";break;case"e":s.mode="rotate"}h.controllersRecursive().forEach(e=>e.updateDisplay())})}(),B(),function o(){let l=window.performance.now()-E;for(let o in E=window.performance.now(),a.rotation.y+=b.speed*l*.001,a.updateMatrixWorld(),e.begin(),n&&n.update(),r.render(t,i),e.end(),M)M[o].visible=!1;let d=b.shape,p=M[d];p.visible=!0,p.position.copy(b.position),p.rotation.copy(b.rotation),p.scale.copy(b.scale);let h=new f.Matrix4().copy(a.matrixWorld).invert().multiply(p.matrixWorld);if("sphere"===d){let e=new f.Sphere(void 0,1);e.applyMatrix4(h);let t=a.geometry.boundsTree.intersectsSphere(e);p.material.color.set(t?15277667:6710886),p.material.emissive.set(15277667).multiplyScalar(t?.25:0)}else if("box"===d){let e=new f.Box3;e.min.set(-.5,-.5,-.5),e.max.set(.5,.5,.5);let t=a.geometry.boundsTree.intersectsBox(e,h);p.material.color.set(t?15277667:6710886),p.material.emissive.set(15277667).multiplyScalar(t?.25:0)}else if("geometry"===d){let e=a.geometry.boundsTree.intersectsGeometry(p.geometry,h);p.material.color.set(e?15277667:6710886),p.material.emissive.set(15277667).multiplyScalar(e?.25:0)}s.object!==p&&s.attach(p),requestAnimationFrame(o)}();
//# sourceMappingURL=shapecast.9bb13e8b.js.map
